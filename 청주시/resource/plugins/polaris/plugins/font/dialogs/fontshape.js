(function(){POLARIS.dialog.add("fontShape",function(d){function t(a,c,b,e){d.ui.addButton(a,{label:c,toolbar:"dialog_property_button",click:e?e:function(){var b=p(),c=new POLARIS.dom.range(b.getDocument());c.selectNodeContents(b);this.getState()==POLARIS.TRISTATE_ON?(g[a].removeFromRange(c),this.setState(POLARIS.TRISTATE_OFF)):(g[a].applyToRange(c),this.setState(POLARIS.TRISTATE_ON))}});if(c=d.ui.create(a))b.push('\x3cli class\x3d"polaris_dialog_property_button"\x3e'),c.className=c.className?c.className+
" polaris_dialog_button":"polaris_dialog_button",c.render(d,b),b.push("\x3c/li\x3e");u.push(c);q[a]=c}function p(){var a=POLARIS.document.getById(w);if(a)return a.getFrameDocument().getById(A)}function v(a){return"false"==a.getAttribute("contentEditable")||a.getAttribute("data-nostyle")}function E(a,c,b,e){a=b.split(";");b=[];for(var n={},d=0;d<a.length;d++){var f=a[d];if(f){var f=f.split("/"),g={},k=a[d]=f[0];g[c]=b[d]=f[1]||k;n[k]=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},e,!0),
g);n[k]._.definition.name=k}else a.splice(d--,1)}return n}function x(a,c){var b=d.elementPath(),e=b.contains(function(b){return a.checkElementRemovable(b)});if(e){var n=c.checkBoundaryOfElement(e,POLARIS.START),f=c.checkBoundaryOfElement(e,POLARIS.END);if(n&&f){for(n=c.createBookmark();b=e.getFirst();)b.insertBefore(e);e.remove();c.moveToBookmark(n)}else n?c.moveToPosition(e,POLARIS.POSITION_BEFORE_START):f?c.moveToPosition(e,POLARIS.POSITION_AFTER_END):(c.splitElement(e),c.moveToPosition(e,POLARIS.POSITION_AFTER_END),
B(c,b.elements.slice(),e));d.getSelection().selectRanges([c])}}function B(a,c,b){var e=c.pop();if(e){if(b)return B(a,c,e.equals(b)?null:b);b=e.clone();a.insertNode(b);a.moveToPosition(b,POLARIS.POSITION_AFTER_START);B(a,c)}}function y(a){0==a.getContentElement("advanced","borderTop").getValue()&&0==a.getContentElement("advanced","borderBottom").getValue()&&0==a.getContentElement("advanced","borderLeft").getValue()&&0==a.getContentElement("advanced","borderRight").getValue()&&a.getContentElement("advanced",
"selBorderStyle").setValue("none")}function z(a){"none"==a.getContentElement("advanced","selBorderStyle").getValue()&&a.getContentElement("advanced","selBorderStyle").setValue("solid")}var f=d.lang.font,C=d.plugins.uicolor,g=[];g.bold=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},POLARIS.config.coreStyles_bold,!0));g.bold.type=POLARIS.STYLE_INLINE;g.italic=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},POLARIS.config.coreStyles_italic,!0));g.italic.type=POLARIS.STYLE_INLINE;
g.underline=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},POLARIS.config.coreStyles_underline,!0));g.underline.type=POLARIS.STYLE_INLINE;g.strike=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},POLARIS.config.coreStyles_strike,!0));g.strike.type=POLARIS.STYLE_INLINE;g.subscript=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},POLARIS.config.coreStyles_subscript,!0));g.subscript.type=POLARIS.STYLE_INLINE;g.superscript=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},
POLARIS.config.coreStyles_superscript,!0));g.superscript.type=POLARIS.STYLE_INLINE;var u=[],q={},m=[];m.push("\x3cspan\x3e"+f.properties+'\x3c/span\x3e\x3cul class\x3d"polaris_dialog_property_buttons"\x3e');t("bold",d.lang.basicstyles.bold,m);t("italic",d.lang.basicstyles.italic,m);t("strike",d.lang.basicstyles.strike,m);t("underline",d.lang.basicstyles.underline,m);t("superscript",d.lang.basicstyles.superscript,m,function(){var a=p(),c=new POLARIS.dom.range(a.getDocument());c.selectNodeContents(a);
this.getState()==POLARIS.TRISTATE_ON?(g.superscript.removeFromRange(c),this.setState(POLARIS.TRISTATE_OFF)):(g.superscript.applyToRange(c),this.setState(POLARIS.TRISTATE_ON),g.subscript.removeFromRange(c),q.subscript.setState(POLARIS.TRISTATE_OFF))});t("subscript",d.lang.basicstyles.subscript,m,function(){var a=p(),c=new POLARIS.dom.range(a.getDocument());c.selectNodeContents(a);this.getState()==POLARIS.TRISTATE_ON?(g.subscript.removeFromRange(c),this.setState(POLARIS.TRISTATE_OFF)):(g.subscript.applyToRange(c),
this.setState(POLARIS.TRISTATE_ON),g.superscript.removeFromRange(c),q.superscript.setState(POLARIS.TRISTATE_OFF))});t("RemoveFormat",f.removeStyle,m,function(){if(u){for(var a=0;a<u.length;a++){var c=u[a];c.getState()==POLARIS.TRISTATE_ON&&c.click()}this.setState(POLARIS.TRISTATE_OFF)}});m.push("\x3c/ul\x3e\x3c/span\x3e");var w=POLARIS.tools.getNextId()+"_textPreviewFrame",A=POLARIS.tools.getNextId()+"_textPreviewPanel",r=E(d,"family",d.config.font_names,d.config.font_style),D=E(d,"fontsize",d.config.fontSize_sizes,
{element:"span",styles:{"font-size":"#(fontsize)"},overrides:[{element:"font",attributes:{size:null}}]}),k=[],l=[];return{title:f.label,minWidth:298,minHeight:36,resizable:POLARIS.DIALOG_RESIZE_NONE,contents:[{id:"info",label:d.lang.common.generalTab,elements:[{type:"hbox",widths:["50%","50%"],children:[{type:"select",id:"fontFamily",label:f.fontFamily,items:[],setup:function(a){this.clear();for(var c in r)this.add(c);if(a){a=(new POLARIS.dom.elementPath(a)).elements;for(var b=0,e;b<a.length;b++)for(c in e=
a[b],r)if(r[c].checkElementMatch(e,!0,d)){this.setValue(c);k.family=r[c];return}}this.setValue(d.config.documentFontFamily)},onChange:function(){var a=p(),c=new POLARIS.dom.range(a.getDocument());c.selectNodeContents(a);l.family&&l.family.removeFromRange(c);r[this.getValue()].applyToRange(c);l.family=r[this.getValue()]},commit:function(a){k.family&&(a=d.getSelection().getRanges()[0],d.focus(),a.collapsed?x(k.family,a):k.family.remove(d));if(l.family){d.focus();var c=this.getValue();(a=d.plugins.tablecellblock)&&
a.isSelected()?a.getSelectedCells().forEach(function(a){var e=new POLARIS.dom.range(d.document);e.selectNodeContents(a);r[c].applyToRange(e)}):r[c].apply(d)}}},{type:"html",id:"fontSize",html:"",setup:function(a){this.getDialog();var c="polaris_"+POLARIS.tools.getNextId()+"_textInput",b="polaris_"+POLARIS.tools.getNextId()+"_selectBox",e='\x3cdiv\x3e\x3clabel class\x3d"polaris_dialog_ui_labeled_label" \x3e'+f.fontSize.panelTitle+'\x3c/label\x3e\x3cdiv class\x3d"polaris_dialog_ui_labeled_content" \x3e\x3cdiv class\x3d"polaris_dialog_ui_editable_select_box" \x3e\x3cselect class\x3d"polaris_dialog_ui_editable_select" id\x3d"'+
b+'"\x3e\x3c/select\x3e\x3cinput type\x3d"text" class\x3d"polaris_dialog_ui_editable_input" id\x3d"'+c+'" onclick\x3d"this.select()" \x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';this.getElement().setHtml(e);var n=document.getElementById(c),g=document.getElementById(b);this.getInputElement=function(){return n};this.getSelectBoxElement=function(){return g};this.getValue=function(){return n.value};c=function(a){var b=p(),c=new POLARIS.dom.range(b.getDocument());c.selectNodeContents(b);l.fontsize&&l.fontsize.removeFromRange(c);
a=a.getFontSizeStyle(a.getValue());a.applyToRange(c);l.fontsize=a};this.getFontSizeStyle=function(a){var b=D[a];b||(a={size:a+"pt"},b=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},POLARIS.config.fontSize_style,!0),a));return b};for(var h in D)b=document.createElement("option"),b.text=h,g.add(b);if(a)for(a=(new POLARIS.dom.elementPath(a)).elements,b=0;b<a.length;b++){e=a[b];for(h in D)if(this.getFontSizeStyle(h).checkElementMatch(e,!0,d)){n.value=h;k.fontsize=this.getFontSizeStyle(h);c(this);
return}if((e=e.getStyle("font-size"))&&0<e.length){h=e.replace(/[0-9|.|-]/g,"");"pt"==h&&(e=e.replace(h,""));n.value=e;k.fontsize=this.getFontSizeStyle(e);c(this);return}}c(this);n.value=d.config.documentFontSize},onKeydown:function(a){var c=a.data.$.keyCode;if(47<c&&58>c||95<c&&106>c||35==c||36==c||37==c||39==c||8==c||46==c)return!0;a.data.preventDefault();return!1},onChange:function(a){a=a.data.$;a=a.target?a.target:a.path[0];var c=this.getInputElement(),b=p(),e=new POLARIS.dom.range(b.getDocument());
e.selectNodeContents(b);l.fontsize&&l.fontsize.removeFromRange(e);b=this.getFontSizeStyle(a.value);b.applyToRange(e);l.fontsize=b;c.value=a.value},commit:function(a){k.fontsize&&(a=d.getSelection().getRanges()[0],d.focus(),a.collapsed?x(k.fontsize,a):k.fontsize.remove(d));if(l.fontsize){d.focus();var c=this.getFontSizeStyle(this.getValue());a=parseInt(this.getValue());if(100<a||8>a)100<a?this.getInputElement().value="100":this.getInputElement().value="8",c=this.getFontSizeStyle(this.getValue()),a=
"\x3ctable\x3e\x3cthead\x3e\x3ctr\x3e",a+="\x3cth colspan\x3d3\x3e글꼴의 크기는 8이상 100이하이어야 합니다.\x3cbr\x3e\x3cbr\x3e\x3c/th\x3e",a+="\x3c/tr\x3e",a+="\x3c/thead\x3e",a+="\x3c/table\x3e",(new POLARIS.plugins.notification(d,{message:a,type:"info",duration:3E3,width:300,valign:"top",align:"center"})).show();(a=d.plugins.tablecellblock)&&a.isSelected()?a.getSelectedCells().forEach(function(a){var e=new POLARIS.dom.range(d.document);e.selectNodeContents(a);c.applyToRange(e)}):c.apply(d)}}}]},{type:"html",html:""},
{type:"html",html:m.join("")},{type:"html",html:""},{type:"hbox",widths:["50%","50%"],children:[{type:"vbox",children:[{type:"html",html:"\x3cspan\x3e"+f.fontColor+"\x3c/span\x3e"},{type:"vbox",className:"color_choose_parent",children:[{type:"button",id:"fontColor","class":"colorChooser",label:"",onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},setup:function(a){this.getFontColorStyle=function(a){a={element:"span",styles:{color:a.toLowerCase()}};a=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1,
childRule:function(a){return!(a.is("a")||a.getElementsByTag("a").count())||v(a)}},a,!0));a.type=POLARIS.STYLE_INLINE;return a};if(a){a=(new POLARIS.dom.elementPath(a)).elements;for(var c,b=0;b<a.length;b++){var e=a[b];if(e&&"span"==e.getName()&&(e=e.getStyle("color"))){c=e;break}}c=c?c:"#000000";this.setValue(c);this.getElement().setStyle("background-color",c);k.color=this.getFontColorStyle(c)}},onClick:function(){C&&d.getUIColorFromDialog(function(a){a&&(this.getElement().setStyle("background-color",
a),this.setValue(a),this.onChange())},this)},onChange:function(){var a=p(),c=new POLARIS.dom.range(a.getDocument());c.selectNodeContents(a);l.color&&l.color.removeFromRange(c);if(a=this.getValue())a=this.getFontColorStyle(a),a._.definition.childRule=function(a){return 0},a.applyToRange(c),l.color=a},isChanged:function(){return this.getValue()!=this.getInitValue()},setInitValue:function(){this._.initValue="#000000"},getInitValue:function(){return this._.initValue},commit:function(){if(l.color){if(k.color){var a=
d.getSelection().getRanges()[0];d.focus();a.collapsed?x(k.color,a):k.color.remove(d)}if(a=this.getValue()){var c=this.getFontColorStyle(a);d.focus();l.fontsize&&(d.focus(),(a=d.plugins.tablecellblock)&&a.isSelected()?a.getSelectedCells().forEach(function(a){var e=new POLARIS.dom.range(d.document);e.selectNodeContents(a);c.applyToRange(e)}):c.apply(d))}}}}]}]},{type:"vbox",children:[{type:"html",html:"\x3cspan\x3e"+f.fontBgColor+"\x3c/span\x3e"},{type:"vbox",className:"color_choose_parent",children:[{type:"button",
id:"bgColor","class":"colorChooser",label:"",onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},setup:function(a){this.getBgColorStyle=function(a){a={element:"span",styles:{"background-color":a.toLowerCase()}};a=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1,childRule:function(a){return v(a)}},a,!0));a.type=POLARIS.STYLE_INLINE;return a};if(a){a=(new POLARIS.dom.elementPath(a)).elements;for(var c,b=0;b<a.length;b++){var e=a[b];if(e&&"span"==e.getName()&&
(e=e.getStyle("background-color"))){c=e;break}}c=c?c:"#ffffff";this.setValue(c);this.getElement().setStyle("background-color",c);k.bgcolor=this.getBgColorStyle(c)}},onClick:function(){C&&d.getUIColorFromDialog(function(a){a&&(this.getElement().setStyle("background-color",a),this.setValue(a),this.onChange())},this)},onChange:function(){var a=p(),c=new POLARIS.dom.range(a.getDocument());c.selectNodeContents(a);l.bgcolor&&l.bgcolor.removeFromRange(c);if(a=this.getValue())a=this.getBgColorStyle(a),a._.definition.childRule=
function(a){return 0},a.applyToRange(c),l.bgcolor=a},isChanged:function(){return this.getValue()!=this.getInitValue()},setInitValue:function(){this._.initValue="#ffffff"},getInitValue:function(){return this._.initValue},commit:function(){if(l.bgcolor){if(k.bgcolor){var a=d.getSelection().getRanges()[0];d.focus();a.collapsed?x(k.bgcolor,a):k.bgcolor.remove(d)}if(a=this.getValue()){var c=this.getBgColorStyle(a);c.type=POLARIS.STYLE_INLINE;d.focus();(a=d.plugins.tablecellblock)&&a.isSelected()?a.getSelectedCells().forEach(function(a){var e=
new POLARIS.dom.range(d.document);e.selectNodeContents(a);c.applyToRange(e)}):c.apply(d)}}}}]}]}]},{type:"html",html:""},{type:"html",html:"\x3cspan\x3e"+f.preview+'\x3c/span\x3e\x3ciframe id\x3d"'+w+'" marginheight\x3d"0px" marginwidth\x3d"0px" scrolling\x3d"no" style\x3d"border: 1px solid #a0a2ab;border-radius:2px;width:calc(100% - 2px);height:70px;display:block;"\x3e\x3c/iframe\x3e'}]},{id:"advanced",label:d.lang.common.advancedTab,elements:[{type:"vbox",children:[{type:"hbox",widths:["50%","50%"],
children:[{type:"select",id:"txtBorderWidth",label:f.borderWidth,items:[[f.borderWidthTypes[0][0],f.borderWidthTypes[0][1]],[f.borderWidthTypes[1][0],f.borderWidthTypes[1][1]],[f.borderWidthTypes[2][0],f.borderWidthTypes[2][1]],[f.borderWidthTypes[3][0],f.borderWidthTypes[3][1]],[f.borderWidthTypes[4][0],f.borderWidthTypes[4][1]],[f.borderWidthTypes[5][0],f.borderWidthTypes[5][1]],[f.borderWidthTypes[6][0],f.borderWidthTypes[6][1]],[f.borderWidthTypes[7][0],f.borderWidthTypes[7][1]],[f.borderWidthTypes[8][0],
f.borderWidthTypes[8][1]],[f.borderWidthTypes[9][0],f.borderWidthTypes[9][1]],[f.borderWidthTypes[10][0],f.borderWidthTypes[10][1]],[f.borderWidthTypes[11][0],f.borderWidthTypes[11][1]],[f.borderWidthTypes[12][0],f.borderWidthTypes[12][1]],[f.borderWidthTypes[13][0],f.borderWidthTypes[13][1]],[f.borderWidthTypes[14][0],f.borderWidthTypes[14][1]],[f.borderWidthTypes[15][0],f.borderWidthTypes[15][1]],[f.borderWidthTypes[16][0],f.borderWidthTypes[16][1]]],setup:function(){this.setValue("0.12mm")},onChange:function(){var a=
this.getDialog().getContentElement("advanced","borderTop").getValue(),c=this.getDialog().getContentElement("advanced","borderBottom").getValue(),b=this.getDialog().getContentElement("advanced","borderLeft").getValue(),e=this.getDialog().getContentElement("advanced","borderRight").getValue(),d=this.getDialog().getContentElement("advanced","txtBorderWidth").getValue(),f=POLARIS.document.getById("polaris_font_border_preview");a&&f.setStyle("border-top-width",d);c&&f.setStyle("border-bottom-width",d);
b&&f.setStyle("border-left-width",d);e&&f.setStyle("border-right-width",d)}},{id:"selBorderStyle",type:"select","default":"solid",label:f.borderStyle,items:[[f.borderStyles.border_none,"none"],[f.borderStyles.border_solid,"solid"],[f.borderStyles.border_double,"double"],[f.borderStyles.border_dashed,"dashed"],[f.borderStyles.border_dotted,"dotted"]],validate:function(){if(k.border){var a=d.getSelection().getRanges()[0];if(!a||a.collapsed)return alert(f.changingStyleNeedSelection),!1}},setup:function(a){},
onChange:function(){var a=this.getDialog().getContentElement("advanced","borderTop").getValue(),c=this.getDialog().getContentElement("advanced","borderBottom").getValue(),b=this.getDialog().getContentElement("advanced","borderLeft").getValue(),e=this.getDialog().getContentElement("advanced","borderRight").getValue(),d=this.getDialog().getContentElement("advanced","selBorderStyle").getValue(),f=POLARIS.document.getById("polaris_font_border_preview");1==a&&f.setStyle("border-top-style",d);1==c&&f.setStyle("border-bottom-style",
d);1==b&&f.setStyle("border-left-style",d);1==e&&f.setStyle("border-right-style",d);"none"==this.getValue()&&(this.getDialog().getContentElement("advanced","borderTop").setValue(!1),this.getDialog().getContentElement("advanced","borderBottom").setValue(!1),this.getDialog().getContentElement("advanced","borderLeft").setValue(!1),this.getDialog().getContentElement("advanced","borderRight").setValue(!1))},commit:function(a){}}]},{type:"hbox",widths:["50%","50%"],children:[{type:"vbox",children:[{type:"html",
html:"\x3cspan\x3e"+f.borderColor+"\x3c/span\x3e"},{type:"vbox",className:"color_choose_parent",children:[{type:"button",id:"txtBorderColor","class":"colorChooser",label:"",onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){C&&d.getUIColorFromDialog(function(a){a&&(this.getElement().setStyle("background-color",a),this.setValue(a),this.onChange())},this)},onChange:function(){var a=this.getDialog().getContentElement("advanced","borderTop").getValue(),
c=this.getDialog().getContentElement("advanced","borderBottom").getValue(),b=this.getDialog().getContentElement("advanced","borderLeft").getValue(),e=this.getDialog().getContentElement("advanced","borderRight").getValue(),d=this.getValue(),f=POLARIS.document.getById("polaris_font_border_preview");a&&f.setStyle("border-top-color",d);c&&f.setStyle("border-bottom-color",d);b&&f.setStyle("border-left-color",d);e&&f.setStyle("border-right-color",d)},isChanged:function(){return this.getValue()!=this.getInitValue()},
setInitValue:function(){this._.initValue="#000000"},getInitValue:function(){return this._.initValue},commit:function(){}}]}]},{type:"html",html:""}]},{type:"vbox",children:[{type:"html",html:"\x3cspan\x3e"+f.borderSelection+"\x3c/span\x3e"},{type:"vbox",style:"border: 1px solid #a0a2ab; border-radius: 2px; background-color: #fffeff; padding: 5px; height: 100%;",textalign:"center",className:"preview_box",children:[{type:"html",html:'\x3cspan style\x3d"text-align:center; vertical-align: middle;"\x3e'+
f.borderSelectionInfo+"\x3c/span\x3e"},{type:"checkbox",id:"borderTop","default":!1,label:"",onClick:function(){var a=POLARIS.document.getById("polaris_font_border_preview");if(1==this.getValue()){var c=this.getDialog().getContentElement("advanced","txtBorderColor").getValue(),b=this.getDialog().getContentElement("advanced","selBorderStyle").getValue(),e=this.getDialog().getContentElement("advanced","txtBorderWidth").getValue();a.setStyle("border-top-color",c);a.setStyle("border-top-style",b);a.setStyle("border-top-width",
e);z(this.getDialog())}else a.removeStyle("border-top"),y(this.getDialog())},commit:function(a){}},{type:"hbox",verticalalign:"middle",widths:["50%","32px","50%"],children:[{type:"checkbox",id:"borderLeft",style:"float:right;","default":!1,label:"",onClick:function(){var a=POLARIS.document.getById("polaris_font_border_preview");if(1==this.getValue()){var c=this.getDialog().getContentElement("advanced","txtBorderColor").getValue(),b=this.getDialog().getContentElement("advanced","selBorderStyle").getValue(),
e=this.getDialog().getContentElement("advanced","txtBorderWidth").getValue();a.setStyle("border-left-color",c);a.setStyle("border-left-style",b);a.setStyle("border-left-width",e);z(this.getDialog())}else a.removeStyle("border-left"),y(this.getDialog())},commit:function(a){}},{id:"borderPreview",type:"html",html:'\x3cdiv id\x3d"polaris_font_border_preview" style\x3d"width: 32px; height: 32px;"\x3e\x3c/div\x3e',setup:function(a){var c=POLARIS.document.getById("polaris_font_border_preview"),b=a.getStyle("border-top-color");
""!=b?c.setStyle("border-top-color",b):c.setStyle("border-top-color","transparent");b=a.getStyle("border-top-style");""!=b?c.setStyle("border-top-style",b):c.removeStyle("border-top-style");b=a.getStyle("border-top-width");""!=b?c.setStyle("border-top-width",b):c.removeStyle("border-top-width");b=a.getStyle("border-bottom-color");""!=b?c.setStyle("border-bottom-color",b):c.setStyle("border-bottom-color","transparent");b=a.getStyle("border-bottom-style");""!=b?c.setStyle("border-bottom-style",b):c.removeStyle("border-bottom-style");
b=a.getStyle("border-bottom-width");""!=b?c.setStyle("border-bottom-width",b):c.removeStyle("border-bottom-width");b=a.getStyle("border-left-color");""!=b?c.setStyle("border-left-color",b):c.setStyle("border-left-color","transparent");b=a.getStyle("border-left-style");""!=b?c.setStyle("border-left-style",b):c.removeStyle("border-left-style");b=a.getStyle("border-left-width");""!=b?c.setStyle("border-left-width",b):c.removeStyle("border-left-width");b=a.getStyle("border-right-color");""!=b?c.setStyle("border-right-color",
b):c.setStyle("border-right-color","transparent");b=a.getStyle("border-right-style");""!=b?c.setStyle("border-right-style",b):c.removeStyle("border-right-style");a=a.getStyle("border-right-width");""!=a?c.setStyle("border-right-width",a):c.removeStyle("border-right-width");c.removeAttribute("border")}},{type:"checkbox",id:"borderRight",style:"float:left;","default":!1,label:"",onClick:function(){var a=POLARIS.document.getById("polaris_font_border_preview");if(1==this.getValue()){var c=this.getDialog().getContentElement("advanced",
"txtBorderColor").getValue(),b=this.getDialog().getContentElement("advanced","selBorderStyle").getValue(),e=this.getDialog().getContentElement("advanced","txtBorderWidth").getValue();a.setStyle("border-right-color",c);a.setStyle("border-right-style",b);a.setStyle("border-right-width",e);z(this.getDialog())}else a.removeStyle("border-right"),y(this.getDialog())},commit:function(a){}}]},{type:"checkbox",id:"borderBottom","default":!1,label:"",onClick:function(){var a=POLARIS.document.getById("polaris_font_border_preview");
if(1==this.getValue()){var c=this.getDialog().getContentElement("advanced","txtBorderColor").getValue(),b=this.getDialog().getContentElement("advanced","selBorderStyle").getValue(),e=this.getDialog().getContentElement("advanced","txtBorderWidth").getValue();a.setStyle("border-bottom-color",c);a.setStyle("border-bottom-style",b);a.setStyle("border-bottom-width",e);z(this.getDialog())}else a.removeStyle("border-bottom"),y(this.getDialog())},commit:function(a){}}]}]}]}]}],onLoad:function(){var a=POLARIS.document.getById(w);
a&&a.getFrameDocument().write('\x3ctable style\x3d"height:100%;width:100%"\x3e\x3ctr\x3e\x3ctd valign\x3d"bottom" style\x3d"overflow:hidden;white-space:nowrap;"\x3e\x3cspan id\x3d"'+A+'"\x3e안녕하세요 hello 123 \x3c/span\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e')},onShow:function(){var a=this.getParentEditor(),c=a.getSelection().getStartElement();if(c){l=[];k=[];var b=POLARIS.document.getById(w);if(b){b=b.getFrameDocument();b.write('\x3cscript\x3evar preventKeydown\x3dfunction(){event.preventDefault();}\x3c/script\x3e\x3ctable style\x3d"height:100%;width:100%"\x3e\x3ctr\x3e\x3ctd style\x3d"overflow:hidden;white-space:nowrap; vertical-align: middle; text-align: center;"\x3e\x3cspan id\x3d"'+
A+'"\x3e안녕하세요 hello 123 \x3c/span\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e');var e=b.getBody();e.$&&e.$.setAttribute("onkeydown","preventKeydown()");b.appendStyleSheet(POLARIS.getUrl("fonts/fonts.css"))}this.setupContent(c);var b=(new POLARIS.dom.elementPath(c)).elements,d=p(),e=new POLARIS.dom.range(d.getDocument());e.selectNodeContents(d);k.color&&k.color.applyToRange(e);k.bgcolor&&k.bgcolor.applyToRange(e);if(c&&q){c=[];for(d=0;d<b.length;d++){var m=b[d];g.bold.checkElementMatch(m,!0,a)?c.bold=
!0:g.italic.checkElementMatch(m,!0,a)?c.italic=!0:g.underline.checkElementMatch(m,!0,a)?c.underline=!0:g.strike.checkElementMatch(m,!0,a)?c.strike=!0:g.subscript.checkElementMatch(m,!0,a)?c.subscript=!0:g.superscript.checkElementMatch(m,!0,a)&&(c.superscript=!0)}for(var h in q)c[h]?(g[h]&&g[h].applyToRange(e),q[h]&&q[h].setState(POLARIS.TRISTATE_ON),k[h]=g[h]):q[h]&&q[h].setState(POLARIS.TRISTATE_OFF)}this.setBorderWidth=function(a){var b=f.borderWidthTypes;a=POLARIS.tools.convertToUnit(a,"mm",2);
for(var c=parseFloat(a),e=0,d=100;e<b.length;e++){var h=b[e][0],g=Math.abs(c-parseFloat(h));if(d>g)d=g,a=h;else break}this.getContentElement("advanced","txtBorderWidth").setValue(a)};h=this.getContentElement("advanced","txtBorderColor");for(c=0;c<b.length;c++)if((a=b[c])&&"span"==a.getName()&&(a.getStyle("border")||a.getStyle("border-width")||a.getStyle("border-style")||a.getStyle("border-color"))){if(b=POLARIS.document.getById("polaris_font_border_preview"))b.setStyle("border-width",a.getStyle("border-width")),
b.setStyle("border-style",a.getStyle("border-style")),b.setStyle("border-color",a.getStyle("border-color")),c=a.getComputedStyle("border-left-style"),d=a.getComputedStyle("border-top-style"),e=a.getComputedStyle("border-right-style"),b=a.getComputedStyle("border-bottom-style"),c="none"==c||""==c?!1:!0,this.getContentElement("advanced","borderLeft").setValue(c),d="none"==d||""==d?!1:!0,this.getContentElement("advanced","borderTop").setValue(d),e="none"==e||""==e?!1:!0,this.getContentElement("advanced",
"borderRight").setValue(e),b="none"==b||""==b?!1:!0,this.getContentElement("advanced","borderBottom").setValue(b),c?(b=a.getStyle("border-left-style"),b="none"==b||""==b?!1:b,this.getContentElement("advanced","selBorderStyle").setValue(b),b=a.getStyle("border-left-width"),this.setBorderWidth(b),b=a.getStyle("border-left-color"),b="transparent"==b||"rgba(0, 0, 0, 0)"==b||""==b?!1:b,this.getContentElement("advanced","txtBorderColor").setValue(b),h.setValue(b),h.getElement().setStyle("background-color",
b)):d?(b=a.getStyle("border-top-style"),b="none"==b||""==b?!1:b,this.getContentElement("advanced","selBorderStyle").setValue(b),b=a.getStyle("border-top-width"),this.setBorderWidth(b),b=a.getStyle("border-top-color"),b="transparent"==b||"rgba(0, 0, 0, 0)"==b||""==b?!1:b,this.getContentElement("advanced","txtBorderColor").setValue(b),h.setValue(b),h.getElement().setStyle("background-color",b)):e?(b=a.getStyle("border-right-style"),b="none"==b||""==b?!1:b,this.getContentElement("advanced","selBorderStyle").setValue(b),
b=a.getStyle("border-right-width"),this.setBorderWidth(b),b=a.getStyle("border-right-color"),b="transparent"==b||"rgba(0, 0, 0, 0)"==b||""==b?!1:b,this.getContentElement("advanced","txtBorderColor").setValue(b),h.setValue(b),h.getElement().setStyle("background-color",b)):b?(b=a.getStyle("border-bottom-style"),b="none"==b||""==b?!1:b,this.getContentElement("advanced","selBorderStyle").setValue(b),b=a.getStyle("border-bottom-width"),this.setBorderWidth(b),b=a.getStyle("border-bottom-color"),b="transparent"==
b||"rgba(0, 0, 0, 0)"==b||""==b?!1:b,this.getContentElement("advanced","txtBorderColor").setValue(b),h.setValue(b),h.getElement().setStyle("background-color",b)):(this.getContentElement("advanced","selBorderStyle").setValue("solid"),this.setBorderWidth("0.12mm"),this.getContentElement("advanced","txtBorderColor").setValue("rgba(0, 0, 0, 0)"),h.setValue("rgba(0, 0, 0, 0)"),h.getElement().setStyle("background-color","rgba(0, 0, 0, 0)"));h={element:"span",styles:{border:a.getComputedStyle("border")}};
h=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1,childRule:function(a){return v(a)}},h,!0));h.type=POLARIS.STYLE_INLINE;k.border=h;a={element:"span",styles:{"border-width":a.getComputedStyle("border-width"),"border-style":a.getComputedStyle("border-style"),"border-color":a.getComputedStyle("border-color")}};a=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1,childRule:function(a){return v(a)}},a,!0));a.type=POLARIS.STYLE_INLINE;k.border_wsc=a;return}h.setValue("#000000");h.getElement().setStyle("background-color",
"#000000")}else this.hide()},onOk:function(){var a=this.getParentEditor();a.fire("saveSnapshot");this.commitContent(null);u&&u.forEach(function(b){var c,d;c=b.getState();if(d=g[b.name])(b=a.plugins.tablecellblock)&&b.isSelected()?b.getSelectedCells().forEach(function(b){var f=new POLARIS.dom.range(a.document);f.selectNodeContents(b);c===POLARIS.TRISTATE_ON?d.applyToRange(f):d.removeFromRange(f)}):c===POLARIS.TRISTATE_ON?d.apply(a):d.remove(a)});k.border&&k.border.remove(a);k.border_wsc&&k.border_wsc.remove(a);
if("none"!=this.getContentElement("advanced","selBorderStyle").getValue()){var c=POLARIS.document.getById("polaris_font_border_preview");c&&(this.getContentElement("advanced","borderLeft").getValue()||this.getContentElement("advanced","borderTop").getValue()||this.getContentElement("advanced","borderRight").getValue()||this.getContentElement("advanced","borderBottom").getValue())&&(c={element:"span",styles:{"border-top-width":c.getComputedStyle("border-top-width"),"border-top-style":c.getComputedStyle("border-top-style"),
"border-top-color":c.getComputedStyle("border-top-color"),"border-right-width":c.getComputedStyle("border-right-width"),"border-right-style":c.getComputedStyle("border-right-style"),"border-right-color":c.getComputedStyle("border-right-color"),"border-bottom-width":c.getComputedStyle("border-bottom-width"),"border-bottom-style":c.getComputedStyle("border-bottom-style"),"border-bottom-color":c.getComputedStyle("border-bottom-color"),"border-left-width":c.getComputedStyle("border-left-width"),"border-left-style":c.getComputedStyle("border-left-style"),
"border-left-color":c.getComputedStyle("border-left-color")}},c=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1,childRule:function(a){return v(a)}},c,!0)),c.type=POLARIS.STYLE_INLINE,a.focus(),c.apply(a))}}}})})();