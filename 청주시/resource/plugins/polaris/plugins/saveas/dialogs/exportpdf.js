POLARIS.dialog.add("exportPdf",function(b){var c,h=function(){var a={};b.execCommand("getCurrDocumentId",a);return a.returnValue};return{title:b.lang.saveas.exportPdf.title,minWidth:160,minHeight:40,resizable:POLARIS.DIALOG_RESIZE_NONE,onShow:function(){(this.fileNameFieldElement=this.getContentElement("info","file_name"))&&this.fileNameFieldElement.setValue(this.presetFileName);var a=b.document.findOne('[doc-data-field\x3d"제목"]');if(a&&(a=a.getText(),a=a.replace(/\u200b/g,""),0<a.length)){this.fileNameFieldElement.setValue(a);
return}a=h();if(0>a)this.fileNameFieldElement.setValue(b.lang.saveas.exportPdf.newDocumentFileName);else{var g=this.fileNameFieldElement;b.execCommand("requestGetConvertedFileStatus",{id:a,callback:function(a){var b=a.originalname.lastIndexOf(".");-1<b?(a=a.originalname.substring(0,b),g.setValue(a)):g.setValue(a.originalname)}})}},contents:[{id:"info",label:"",startupFocus:"file_name",elements:[{type:"vbox",children:[{type:"hbox",children:[{id:"file_name",type:"text",style:"width: 172px;",label:b.lang.saveas.labelFileName},
{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",html:".pdf"}]}]}]}]}],buttons:[POLARIS.dialog.okButton(b,{label:b.lang.saveas.exportPdf.exportStr,onClick:function(){var a=this.getDialog(),b=a._.editor,d=a.getContentElement("info","file_name").getValue();if(20<d.length||0>=d.length)alert(b.lang.saveas.fileNameSizeOver.replace("%1",20));else{c?c.setStyle("visibility","visible"):(c=POLARIS.dom.element.createFromHtml('\x3cdiv style\x3d"background-color:rgba(255,255,255,0.95);width:100%;height:100%;top:0;left:0;position:absolute;visibility:visible;z-index:100;"\x3e\x3cdiv style\x3d"display:table;width:100%;height:100%;"\x3e\x3cdiv style\x3d"text-align:center;vertical-align:middle;display:table-cell;"\x3e'+
b.lang.saveas.exportPdf.exporting+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"),c.appendTo(a.parts.dialog),POLARIS.env.ie&&9>POLARIS.env.version&&(c.setStyle("zoom",1),c.setStyle("filter","progid:DXImageTransform.Microsoft.gradient(startColorstr\x3d#EEFFFFFF,endColorstr\x3d#EEFFFFFF)")));a={};b.execCommand("getCurrDocumentId",a);var f=a.returnValue?a.returnValue:"",e=d?d:POLARIS.tools.getRandomFileName(36);params={pageInfo:1,returnValue:"",withCSS:1,convertBRToNBSP:1,convertZWSPToNBSP:1,isDocConvert:1};
b.plugins.pagination.generateHtml(b,params);a=params.returnValue;a={html:a,id:f,path:e+".files/"};b.execCommandAbs("removeRemoteAddrToImgSrc",a);a=a.returnValue;b.execCommandAbs("getBase64EncodeImageInfo",{id:f,path:e+".files/",fileName:e,html:a,callback:function(a){b.execCommandAbs("requestConvertHTMLToDocAtOnce",{id:f,fileName:e+".html",extension:"pdf",html:a.content,imgNames:a.imgNames,imgUris:a.imgUris,resultPath:"",callback:function(a){b.resetDirty();b.execCommand("requestGetPDFFileDownload",
{id:a.convertId,stamp:a.stamp,fileName:d+".pdf"});c.setStyle("visibility","hidden");POLARIS.dialog.getCurrent().hide()}})}})}}}),POLARIS.dialog.cancelButton(b,{label:b.lang.common.close})]}});