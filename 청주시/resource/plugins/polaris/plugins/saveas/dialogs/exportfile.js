POLARIS.dialog.add("exportFile",function(b){var d,h=function(){var a={};b.execCommand("getCurrDocumentId",a);return a.returnValue},k=function(a){d?d.setStyle("visibility","visible"):(d=POLARIS.dom.element.createFromHtml('\x3cdiv style\x3d"background-color:rgba(255,255,255,0.95);width:100%;height:100%;top:0;left:0;position:absolute;visibility:visible;z-index:100;"\x3e\x3cdiv style\x3d"display:table;width:100%;height:100%;"\x3e\x3cdiv style\x3d"text-align:center;vertical-align:middle;display:table-cell;"\x3e'+
b.lang.saveas.exportPDF.exporting+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"),d.appendTo(a.parts.dialog),POLARIS.env.ie&&9>POLARIS.env.version&&(d.setStyle("zoom",1),d.setStyle("filter","progid:DXImageTransform.Microsoft.gradient(startColorstr\x3d#EEFFFFFF,endColorstr\x3d#EEFFFFFF)")))},g=function(a){var c=a.getContentElement("info","file_format").domId;a=a.parts.contents.findOne('[id\x3d"'.concat(c,'"]'));c="";a&&(c=a.getText());return c},l=function(a){var c=a._.editor,e=a.getContentElement("info","file_name").getValue();
if(20<e.length||0>=e.length)alert(c.lang.saveas.fileNameSizeOver.replace("%1",20));else{k(a);a={};c.execCommand("getCurrDocumentId",a);var b=a.returnValue?a.returnValue:"",f=e?e:POLARIS.tools.getRandomFileName(36);params={pageInfo:1,returnValue:"",withCSS:1,convertBRToNBSP:1,convertZWSPToNBSP:1,isDocConvert:1};c.plugins.pagination.generateHtml(c,params);a=params.returnValue;a={html:a,id:b,path:f+".files/"};c.execCommandAbs("removeRemoteAddrToImgSrc",a);a=a.returnValue;c.execCommandAbs("getBase64EncodeImageInfo",
{id:b,path:f+".files/",fileName:f,html:a,callback:function(a){c.execCommandAbs("requestConvertHTMLToDocAtOnce",{id:b,fileName:f+".html",extension:"pdf",html:a.content,imgNames:a.imgNames,imgUris:a.imgUris,resultPath:"",callback:function(a){c.resetDirty();c.execCommand("requestGetPDFFileDownload",{id:a.convertId,stamp:a.stamp,fileName:e+".pdf"});d.setStyle("visibility","hidden");POLARIS.dialog.getCurrent().hide()}})}})}};return{title:b.lang.saveas.exportFile,minWidth:263,minHeight:40,resizable:POLARIS.DIALOG_RESIZE_NONE,
onShow:function(){(this.fileNameFieldElement=this.getContentElement("info","file_name"))&&this.fileNameFieldElement.setValue(this.presetFileName);var a=b.document.findOne('[doc-data-field\x3d"제목"]');if(a&&(a=a.getText(),a=a.replace(/\u200b/g,""),0<a.length)){this.fileNameFieldElement.setValue(a);return}if("pdf"===this.getContentElement("info","file_format"))if(a=h(),0>a)this.fileNameFieldElement.setValue(b.lang.saveas.exportPDF.newDocumentFileName);else{var c=this.fileNameFieldElement;b.execCommand("requestGetConvertedFileStatus",
{id:a,callback:function(a){var b=a.originalname.lastIndexOf(".");-1<b?(a=a.originalname.substring(0,b),c.setValue(a)):c.setValue(a.originalname)}})}},contents:[{id:"info",label:"",startupFocus:"file_name",elements:[{type:"vbox",children:[{type:"hbox",widths:["230px","auto"],children:[{id:"file_name",type:"text",label:b.lang.saveas.labelFileName},{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",id:"file_format",html:"pdf",style:"line-height:32px;font-size:12px;"}]}]}]}]}],buttons:[POLARIS.dialog.okButton(b,
{label:b.lang.saveas.exportPDF.exportStr,onClick:function(){var a=this.getDialog();if("pdf"===g(a))l(a);else{var c=a._.editor,a=a.getContentElement("info","file_name").getValue()+"."+g(a),c=c.apis.GetTextFile("html");if(navigator.msSaveBlob)c=new Blob([c],{type:"data:text/html;charset\x3dutf-8;"}),navigator.msSaveBlob(c,a);else{var b=document.createElement("a");b.setAttribute("href","data:text/html;charset\x3dutf-8,"+encodeURIComponent(c));b.setAttribute("download",a);b.style.display="none";document.body.appendChild(b);
b.click();document.body.removeChild(b)}}}}),POLARIS.dialog.cancelButton(b,{label:b.lang.common.close})]}});