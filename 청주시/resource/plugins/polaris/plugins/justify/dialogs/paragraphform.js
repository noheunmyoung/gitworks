(function(){POLARIS.dialog.add("paragraphform",function(h){function A(a,b,e,c){h.ui.addButton(a,{label:b,toolbar:"dialog_property_button",click:c?c:function(){var b=p(),c=new POLARIS.dom.range(b.getDocument());c.selectNodeContents(b);x&&(x.setState(POLARIS.TRISTATE_OFF),k[x.name].removeFromRange(c));this.setState(POLARIS.TRISTATE_ON);k[a].applyToRange(c);x=this}});if(b=h.ui.create(a))e.push('\x3cli class\x3d"polaris_dialog_property_button"\x3e'),b.className=b.className?b.className+" polaris_dialog_button":
"polaris_dialog_button",b.render(h,e),e.push("\x3c/li\x3e");y.push(b);r[a]=b}function p(){var a=POLARIS.document.getById(C);if(a)return a.getFrameDocument().getById(E)}function D(a,b,e){return function(){var c=this.getValue().trim(),c=!!(c>=b&&c<e+1);c||(alert(a),this.select());return c}}var a=h.lang.justify,G=h.plugins.uicolor,k=[];k.justifyleft=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},{element:"strong",styles:{"text-align":"left",display:"block"}},!0));k.justifyleft.type=POLARIS.STYLE_INLINE;
k.justifycenter=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},{element:"strong",styles:{"text-align":"center",display:"block"}},!0));k.justifycenter.type=POLARIS.STYLE_INLINE;k.justifyright=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},{element:"strong",styles:{"text-align":"right",display:"block"}},!0));k.justifyright.type=POLARIS.STYLE_INLINE;k.justifyblock=new POLARIS.style(POLARIS.tools.extend({ignoreReadonly:1},{element:"strong",styles:{"text-align":"justify",display:"block"}},
!0));k.justifyblock.type=POLARIS.STYLE_INLINE;var y=[],r=[],x,u=[];u.push("\x3cspan\x3e"+a.paragraph.align+'\x3c/span\x3e\x3cul class\x3d"polaris_dialog_property_buttons"\x3e');A("justifyleft",a.left,u);A("justifycenter",a.center,u);A("justifyright",a.right,u);A("justifyblock",a.block,u);u.push("\x3c/ul\x3e\x3c/span\x3e");var C=POLARIS.tools.getNextId()+"_textPreviewFrame",E=POLARIS.tools.getNextId()+"_textPreviewPanel";return{title:a.paragraph.title,minWidth:298,minHeight:36,resizable:POLARIS.DIALOG_RESIZE_NONE,
contents:[{id:"info",label:h.lang.common.generalTab,elements:[{type:"html",html:""},{type:"html",className:"label_line_height_20",html:u.join("")},{type:"hbox",widths:["50%","50%"],children:[{type:"hbox",widths:["80%","20%"],children:[{type:"text",id:"txtTopMargin",maxLength:4,label:a.paragraph.topMargin,validate:D(a.paragraph.invalidTopMargin,0,100),"default":"0",onKeyUp:function(){p().setStyle("margin-top",this.getValue()+a.verticalUnit)},onChange:function(){p().setStyle("margin-top",this.getValue()+
a.verticalUnit)}},{type:"vbox",children:[{type:"html",html:'\x3cdiv class\x3d"parent" style\x3d"display: table; height: 42px;"\x3e\x3cspan class\x3d"child" style\x3d"display: table-cell; vertical-align: bottom; font-size: 12px;"\x3e'+a.verticalUnit+"\x3c/span\x3e\x3c/div\x3e"}]}]},{type:"hbox",widths:["80%","20%"],children:[{type:"text",id:"txtBottomMargin",maxLength:4,label:a.paragraph.bottomMargin,validate:D(a.paragraph.invalidBottomMargin,0,100),"default":"0",onKeyUp:function(){p().setStyle("margin-bottom",
this.getValue()+a.verticalUnit)},onChange:function(){p().setStyle("margin-bottom",this.getValue()+a.verticalUnit)}},{type:"vbox",children:[{type:"html",html:'\x3cdiv class\x3d"parent" style\x3d"display: table; height: 42px;"\x3e\x3cspan class\x3d"child" style\x3d"display: table-cell; vertical-align: bottom; font-size: 12px;"\x3e'+a.verticalUnit+"\x3c/span\x3e\x3c/div\x3e"}]}]}]},{type:"hbox",widths:["50%","50%"],children:[{type:"hbox",widths:["80%","20%"],children:[{type:"text",id:"txtLeftMargin",
maxLength:4,label:a.paragraph.leftMargin,validate:function(){var d=this.getValue().trim(),b=-parseFloat(h.plugins.pagination.pageInfo.marginLeft),d=!!(d>=b&&100>=d);d||(alert(a.paragraph.invalidLeftMargin.replace("%1",b)),this.select());return d},"default":"0",onKeyUp:function(){var d=p(),b=this.getDialog(),e=this.getValue(),c=b.getContentElement("info","radioFirstLineIndent"),b=b.getContentElement("info","txtIndentValue");c.getValue()==a.paragraph.firstLine.outdent&&(e=parseFloat(e)+parseFloat(b.getValue()));
d.setStyle("margin-left",e+a.verticalUnit)},onChange:function(){var d=p(),b=this.getDialog(),e=this.getValue(),c=b.getContentElement("info","radioFirstLineIndent"),b=b.getContentElement("info","txtIndentValue");c.getValue()==a.paragraph.firstLine.outdent&&(e=parseFloat(e)+parseFloat(b.getValue()));d.setStyle("margin-left",e+a.verticalUnit)}},{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",html:a.verticalUnit,style:"line-height: 32px;"}]}]},{type:"hbox",widths:["80%","20%"],children:[{type:"text",
id:"txtRightMargin",maxLength:4,label:a.paragraph.rightMargin,validate:function(){var d=this.getValue().trim(),b=-parseFloat(h.plugins.pagination.pageInfo.marginRight),d=!!(d>=b&&100>=d);d||(alert(a.paragraph.invalidRightMargin.replace("%1",b)),this.select());return d},"default":"0",onKeyUp:function(){p().setStyle("margin-right",this.getValue()+a.verticalUnit)},onChange:function(){p().setStyle("margin-right",this.getValue()+a.verticalUnit)}},{type:"vbox",children:[{type:"html",html:"\x26nbsp;"},{type:"html",
html:a.verticalUnit,style:"line-height: 32px;"}]}]}]},{type:"radio",id:"radioFirstLineIndent",label:a.paragraph.firstLine.label,items:[[a.paragraph.firstLine.normal,a.paragraph.firstLine.normal],[a.paragraph.firstLine.indent,a.paragraph.firstLine.indent],[a.paragraph.firstLine.outdent,a.paragraph.firstLine.outdent]],"default":a.paragraph.firstLine.normal,onClick:function(){var d=this.getDialog().getContentElement("info","txtIndentValue");this.getValue()==a.paragraph.firstLine.normal?(d.setValue("0"),
d.getInputElement().setAttribute("disabled")):(""!=d.getValue()&&"0"!=d.getValue()||d.setValue("10"),d.getInputElement().removeAttribute("disabled"));d.onChange()},onChange:function(){var d=this.getDialog().getContentElement("info","txtIndentValue");this.getValue()==a.paragraph.firstLine.normal?d.getInputElement().setAttribute("disabled"):d.getInputElement().removeAttribute("disabled")}},{type:"hbox",widths:["90%","10%"],children:[{type:"text",id:"txtIndentValue",maxLength:4,"default":"10",validate:function(){var d=
this.getValue().trim(),d=!!(0<=d&&301>d);if(!d){var b=this.getDialog().getContentElement("info","radioFirstLineIndent").getValue();b==a.paragraph.firstLine.indent?alert(a.invalidTextIndent):b==a.paragraph.firstLine.outdent&&alert(a.invalidTextOutdent);this.select()}return d},onKeyUp:function(){var d=p(),b=this.getDialog(),e=b.getContentElement("info","radioFirstLineIndent").getValue(),b=b.getContentElement("info","txtLeftMargin").getValue(),c=this.getValue();e==a.paragraph.firstLine.outdent&&(b=parseFloat(b)+
parseFloat(c),c="-"+c);d.setStyle("text-indent",c+a.verticalUnit);d.setStyle("margin-left",b+a.verticalUnit)},onChange:function(){var d=p(),b=this.getDialog(),e=b.getContentElement("info","radioFirstLineIndent").getValue(),b=b.getContentElement("info","txtLeftMargin").getValue(),c=this.getValue();e==a.paragraph.firstLine.outdent&&(b=parseFloat(b)+parseFloat(c),c="-"+c);d.setStyle("text-indent",c+a.verticalUnit);d.setStyle("margin-left",b+a.verticalUnit)}},{type:"html",html:a.verticalUnit,style:"line-height: 26px;"}]},
{type:"html",html:""},{type:"html",html:"\x3cspan\x3e"+a.paragraph.preview+'\x3c/span\x3e\x3ciframe id\x3d"'+C+'" marginheight\x3d"0px" marginwidth\x3d"0px" scrolling\x3d"no" style\x3d"border: 1px solid #a0a2ab;height:169px;display:block;"\x3e\x3c/iframe\x3e'}]},{id:"advanced",label:h.lang.common.advancedTab,elements:[{type:"vbox",children:[{type:"hbox",widths:["50%","50%"],children:[{type:"select",id:"txtBorderWidth",label:a.paragraph.borderWidth,items:[[a.paragraph.borderWidthTypes[0][0],a.paragraph.borderWidthTypes[0][1]],
[a.paragraph.borderWidthTypes[1][0],a.paragraph.borderWidthTypes[1][1]],[a.paragraph.borderWidthTypes[2][0],a.paragraph.borderWidthTypes[2][1]],[a.paragraph.borderWidthTypes[3][0],a.paragraph.borderWidthTypes[3][1]],[a.paragraph.borderWidthTypes[4][0],a.paragraph.borderWidthTypes[4][1]],[a.paragraph.borderWidthTypes[5][0],a.paragraph.borderWidthTypes[5][1]],[a.paragraph.borderWidthTypes[6][0],a.paragraph.borderWidthTypes[6][1]],[a.paragraph.borderWidthTypes[7][0],a.paragraph.borderWidthTypes[7][1]],
[a.paragraph.borderWidthTypes[8][0],a.paragraph.borderWidthTypes[8][1]],[a.paragraph.borderWidthTypes[9][0],a.paragraph.borderWidthTypes[9][1]],[a.paragraph.borderWidthTypes[10][0],a.paragraph.borderWidthTypes[10][1]],[a.paragraph.borderWidthTypes[11][0],a.paragraph.borderWidthTypes[11][1]],[a.paragraph.borderWidthTypes[12][0],a.paragraph.borderWidthTypes[12][1]],[a.paragraph.borderWidthTypes[13][0],a.paragraph.borderWidthTypes[13][1]],[a.paragraph.borderWidthTypes[14][0],a.paragraph.borderWidthTypes[14][1]],
[a.paragraph.borderWidthTypes[15][0],a.paragraph.borderWidthTypes[15][1]],[a.paragraph.borderWidthTypes[16][0],a.paragraph.borderWidthTypes[16][1]]],setup:function(d){var b=this.getDialog().enableBorderEdges,e=a.paragraph.borderWidthTypes,c="0.12mm";if(b.length){c=d.getStyle("border-"+b[0]+"-width");c=POLARIS.tools.convertToUnit(c,"mm",2);d=parseFloat(c);for(var b=0,f=100;b<e.length;b++){var n=e[b][0],k=Math.abs(d-parseFloat(n));if(f>k)f=k,c=n;else break}}this.setValue(c)},onChange:function(){var a=
this.getDialog().enableBorderEdges,b=POLARIS.document.getById("polaris_paragraph_border_preview"),e=this.getValue();a.forEach(function(a){b.setStyle("border-"+a+"-width",e)})}},{id:"selBorderStyle",type:"select","default":"solid",label:a.paragraph.borderStyle,items:[[a.paragraph.borderStyles.border_none,"none"],[a.paragraph.borderStyles.border_solid,"solid"],[a.paragraph.borderStyles.border_double,"double"],[a.paragraph.borderStyles.border_dashed,"dashed"],[a.paragraph.borderStyles.border_dotted,
"dotted"]],setup:function(a){var b=this.getDialog().enableBorderEdges,e="solid";b.length&&(e=a.getStyle("border-"+b[0]+"-style"));this.setValue(e)},onChange:function(){var a=this.getDialog(),b=a.enableBorderEdges,e=a.getContentElement("advanced","selBorderStyle").getValue(),c=POLARIS.document.getById("polaris_paragraph_border_preview");b.forEach(function(a){c.setStyle("border-"+a+"-style",e)});"none"==this.getValue()&&(a.updateBorderEdge("all",!1),a.getContentElement("advanced","borderTop").setValue(!1),
a.getContentElement("advanced","borderBottom").setValue(!1),a.getContentElement("advanced","borderLeft").setValue(!1),a.getContentElement("advanced","borderRight").setValue(!1))}}]},{type:"hbox",widths:["50%","50%"],children:[{type:"vbox",children:[{type:"html",html:"\x3cspan\x3e"+a.paragraph.bgColor+"\x3c/span\x3e"},{type:"vbox",className:"color_choose_parent",children:[{type:"button",id:"txtBgColor","class":"colorChooser",label:"",onLoad:function(){this.getElement().getParent().setStyle("vertical-align",
"bottom")},onClick:function(){G&&h.getUIColorFromDialog(function(a){var b=this.getDialog().getContentElement("advanced","noBackgroundColor");b&&b.getValue()||!a||(b=POLARIS.document.getById("polaris_paragraph_border_preview"),this.getElement().setStyle("background-color",a),this.setValue(a),b.setStyle("background-color",this.getValue().toLowerCase()))},this)},isChanged:function(){return this.getValue()!=this.getInitValue()},setInitValue:function(){this._.initValue="#ffffff"},getInitValue:function(){return this._.initValue}}]}]},
{type:"vbox",children:[{type:"html",html:"\x3cspan\x3e"+a.paragraph.borderColor+"\x3c/span\x3e"},{type:"vbox",className:"color_choose_parent",children:[{type:"button",id:"txtBorderColor","class":"colorChooser",label:"",onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){G&&h.getUIColorFromDialog(function(a){a&&(this.getElement().setStyle("background-color",a),this.setValue(a),this.onChange())},this)},isChanged:function(){return this.getValue()!=
this.getInitValue()},setInitValue:function(){this._.initValue=this.getValue()},getInitValue:function(){return this._.initValue},onChange:function(){var a=this.getDialog().enableBorderEdges,b=POLARIS.document.getById("polaris_paragraph_border_preview"),e=this.getValue();a.forEach(function(a){b.setStyle("border-"+a+"-color",e)})}}]}]}]},{type:"checkbox",id:"noBackgroundColor","default":!1,label:h.lang.table.noBackgroundColor,onChange:function(){POLARIS.document.getById("polaris_paragraph_border_preview").removeStyle("background-color");
var a=this.getDialog().getContentElement("advanced","txtBgColor");a.getElement().setStyle("background-color","");a.setValue(!1)}},{type:"vbox",children:[{type:"html",html:"\x3cp\x3e"+a.paragraph.borderSelection+"\x3c/p\x3e",style:"font-size: 12px;"},{type:"vbox",style:"border: 1px solid #a0a2ab; border-radius: 2px; background-color: #fffeff; padding: 5px; height: 100%;",textalign:"center",className:"preview_box",children:[{type:"html",html:"\x3cp\x3e"+a.paragraph.borderSelectionInfo+"\x3c/p\x3e",
style:"text-align:center; vertical-align: middle;font-size: 12px;"},{type:"checkbox",id:"borderTop","default":!1,label:"",onClick:function(){this.getDialog().updateBorderEdge("top",this.getValue())}},{type:"hbox",verticalalign:"middle",widths:["50%","32px","50%"],children:[{type:"checkbox",id:"borderLeft",style:"float:right;","default":!1,label:"",onClick:function(){this.getDialog().updateBorderEdge("left",this.getValue())}},{id:"borderPreview",type:"html",html:'\x3cdiv id\x3d"polaris_paragraph_border_preview" style\x3d"width: 32px; height: 32px;"\x3e\x3c/div\x3e',
setup:function(d){var b=POLARIS.document.getById("polaris_paragraph_border_preview"),e=this.getDialog().enableBorderEdges,c=["top","right","bottom","left"].filter(function(a){return-1==e.indexOf(a)});if(e.length){for(var f=a.paragraph.borderWidthTypes,n=d.getStyle("border-"+e[0]+"-color"),k=d.getStyle("border-"+e[0]+"-style"),h=d.getStyle("border-"+e[0]+"-width"),h=POLARIS.tools.convertToUnit(h,"mm",2),p=parseFloat(h),m=0,r=100;m<f.length;m++){var l=f[m][0],t=Math.abs(p-parseFloat(l));if(r>t)r=t,
h=l;else break}e.forEach(function(a){b.setStyle("border-"+a+"-color",n);b.setStyle("border-"+a+"-style",k);b.setStyle("border-"+a+"-width",h)})}c.forEach(function(a){b.setStyle("border-"+a+"-color","#000000");b.setStyle("border-"+a+"-style","solid");b.setStyle("border-"+a+"-width","0px")});b.setStyle("background-color",d.getStyle("background-color"));b.removeAttribute("border")}},{type:"checkbox",id:"borderRight",style:"float:left;","default":!1,label:"",onClick:function(){this.getDialog().updateBorderEdge("right",
this.getValue())}}]},{type:"checkbox",id:"borderBottom","default":!1,label:"",onClick:function(){this.getDialog().updateBorderEdge("bottom",this.getValue())}}]}]}]}]}],onLoad:function(){var a=POLARIS.document.getById(C);a&&a.getFrameDocument().write('\x3ctable style\x3d"height:100%;width:100%"\x3e\x3ctr\x3e\x3ctd valign\x3d"top" style\x3d"font-size:12px; padding: 10px;"\x3e\x3cp style\x3d"margin:0px;"\x3e동해 물과 백두산이 마르고 닳도록 하느님이 보우하사 우리나라 만세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세. \x3c/p\x3e\x3cp id\x3d"'+
E+'" style\x3d"margin:0px;background-color:#d3d3d3;"\x3e남산 위에 저 소나무, 철갑을 두른 듯 바람서리 불변함은 우리 기상일세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세.\x3c/p\x3e\x3cp style\x3d"margin:0px;"\x3e가을 하늘 공활한데 높고 구름 없이 밝은 달은 우리 가슴 일편단심일세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세.\x3c/p\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e')},onShow:function(){function d(a){return h.reduce(function(b,c){var d={};d["border-"+c+"-color"]=a.getStyle("border-"+c+"-color");d["border-"+c+"-style"]=a.getStyle("border-"+c+"-style");d["border-"+c+"-width"]=
a.getStyle("border-"+c+"-width");return POLARIS.tools.extend(b,d)},{})}var b=this,e=this.getParentEditor(),c=e.plugins.tablecellblock;c&&c.isSelected()?(e=c.getSelectedCells(),this.selectedElements=[],e.forEach(function(a){a.find("p").toArray().forEach(function(a){b.selectedElements.push(a)})})):this.selectedElements=POLARIS.tools.getSelectedParagraph(e);if(!this.selectedElements||1>this.selectedElements.length)this.hide();else{var f=POLARIS.tools.isInteger,n=this.selectedElements[0],h=["top","right",
"bottom","left"],e=!1;if(1<this.selectedElements.length)var u=null,e=this.selectedElements.some(function(a){if(u)return!POLARIS.tools.objectCompare(u,d(a));u=d(a);return!1});this.enableBorderEdges=[];this.updateBorderEdge=function(a,b){var c=this.enableBorderEdges.indexOf(a);"all"==a&&b?this.enableBorderEdges=h:"all"!=a||b?b&&-1==c?this.enableBorderEdges.push(a):!b&&-1<c&&this.enableBorderEdges.splice(c,1):this.enableBorderEdges.splice(0);var c=this.getContentElement("advanced","selBorderStyle"),
d=c.getValue(),e=this.getContentElement("advanced","txtBorderColor").getValue(),f=this.getContentElement("advanced","txtBorderWidth").getValue(),g=POLARIS.document.getById("polaris_paragraph_border_preview");"all"!=a&&(b?(g.setStyle("border-"+a+"-color",e),g.setStyle("border-"+a+"-style",d),g.setStyle("border-"+a+"-width",f),"none"==d&&c.setValue("solid")):g.removeStyle("border-"+a));"none"!=d&&0==this.enableBorderEdges.length&&c.setValue("none")};e||(this.enableBorderEdges=h.filter(function(a){var b=
n.getStyle("border-"+a+"-style");a=n.getStyle("border-"+a+"-width");return""!=b&&"none"!=b&&0!=parseFloat(a,2)}));var c=POLARIS.tools.convertToUnit(n.getStyle("margin-left"),"mm",2),z=POLARIS.tools.convertToUnit(n.getStyle("margin-right"),"mm",2),m=POLARIS.tools.convertToUnit(n.getStyle("margin-top"),"mm",2),F=POLARIS.tools.convertToUnit(n.getStyle("margin-bottom"),"mm",2),l=parseFloat(c),t=parseFloat(z),v=parseFloat(m),g=parseFloat(F),l=isNaN(l)?0:l,t=isNaN(t)?0:t,v=isNaN(v)?0:v,g=isNaN(g)?0:g,w=
POLARIS.tools.convertToUnit(n.getStyle("text-indent"),"mm",2),q=parseFloat(w),q=isNaN(q)?0:q;this.getContentElement("info","txtIndentValue").setValue(Math.abs(f(q)?q:q.toFixed(1)));var B=this.getContentElement("info","radioFirstLineIndent");0<q?B.setValue(a.paragraph.firstLine.indent):0>q?(B.setValue(a.paragraph.firstLine.outdent),l+=q):B.setValue(a.paragraph.firstLine.normal);var q=this.getContentElement("info","txtLeftMargin"),B=this.getContentElement("info","txtRightMargin"),A=this.getContentElement("info",
"txtTopMargin"),D=this.getContentElement("info","txtBottomMargin");q.setValue(f(l)?l:l.toFixed(1));B.setValue(f(t)?t:t.toFixed(1));A.setValue(f(v)?v:v.toFixed(1));D.setValue(f(g)?g:g.toFixed(1));if(f=POLARIS.document.getById(C))f=f.getFrameDocument(),f.write('\x3cscript\x3evar preventKeydown\x3dfunction(){event.preventDefault();}\x3c/script\x3e\x3ctable style\x3d"height:100%;width:100%"\x3e\x3ctr\x3e\x3ctd valign\x3d"top" style\x3d"font-size:12px; padding: 10px;"\x3e\x3cp style\x3d"margin:0px;"\x3e동해 물과 백두산이 마르고 닳도록 하느님이 보우하사 우리나라 만세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세. \x3c/p\x3e\x3cp id\x3d"'+
E+'" style\x3d"margin:0px;background-color:#d3d3d3;"\x3e남산 위에 저 소나무, 철갑을 두른 듯 바람서리 불변함은 우리 기상일세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세.\x3c/p\x3e\x3cp style\x3d"margin:0px;"\x3e가을 하늘 공활한데 높고 구름 없이 밝은 달은 우리 가슴 일편단심일세. 무궁화 삼천리 화려강산 대한 사람, 대한으로 길이 보전하세.\x3c/p\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e'),f=f.getBody(),f.$&&f.$.setAttribute("onkeydown","preventKeydown()");if(y)for(f=0;f<y.length;f++)l=y[f],l.getState()==POLARIS.TRISTATE_ON&&l.setState(POLARIS.TRISTATE_OFF);f=p();n&&n.getStyle&&(l=new POLARIS.dom.range(f.getDocument()),
l.selectNodeContents(f),t=n.getStyle("text-align"),"center"==t?(r.justifycenter.setState(POLARIS.TRISTATE_ON),x=r.justifycenter,k.justifycenter.applyToRange(l)):"right"==t?(r.justifyright.setState(POLARIS.TRISTATE_ON),x=r.justifyright,k.justifyright.applyToRange(l)):"justify"==t?(r.justifyblock.setState(POLARIS.TRISTATE_ON),x=r.justifyblock,k.justifyblock.applyToRange(l)):(r.justifyleft.setState(POLARIS.TRISTATE_ON),x=r.justifyleft,k.justifyleft.applyToRange(l)));f.setStyle("margin-top",m?m:"0mm");
f.setStyle("margin-bottom",F?F:"0mm");f.setStyle("margin-left",c?c:"0mm");f.setStyle("margin-right",z?z:"0mm");f.setStyle("text-indent",w?w:"0mm");this.enableBorderEdges.forEach(function(a){a=a.substring(0,1).toUpperCase()+a.substring(1);b.getContentElement("advanced","border"+a).setValue(!0)});c=this.getContentElement("advanced","txtBorderColor");z=c.getElement();m=this.enableBorderEdges.length?n.getStyle("border-"+this.enableBorderEdges[0]+"-color"):"#000000";c.setValue(m);z.setStyle("background-color",
m?m:"#000000");c=this.getContentElement("advanced","txtBgColor");z=c.getElement();m=n.getStyle("background-color");c.setValue(m&&!e?m:"#FFFFFF");z.setStyle("background-color",m?m:"#ffffff");this.setupContent(n)}},onOk:function(){for(var d=this,b=this.getParentEditor(),e=this.selectedElements,c=this.getContentElement("info","txtLeftMargin").getValue(),f=this.getContentElement("info","txtRightMargin").getValue(),h=this.getContentElement("info","txtTopMargin").getValue(),k=this.getContentElement("info",
"txtBottomMargin").getValue(),p=this.getContentElement("info","radioFirstLineIndent").getValue(),r=this.getContentElement("info","txtIndentValue").getValue(),m=POLARIS.document.getById("polaris_paragraph_border_preview"),u=this.getContentElement("advanced","selBorderStyle").getValue(),l=this.getContentElement("advanced","txtBorderColor").getValue(),t=this.getContentElement("advanced","txtBorderWidth").getValue(),m=m.getStyle("background-color"),v=0;v<e.length;v++){var g=e[v];if(!(g.type=POLARIS.NODE_ELEMENT&&
g.is({ol:1,ul:1,dl:1}))){""!=h?g.setStyle("margin-top",h+a.verticalUnit):g.removeStyle("margin-top");""!=k?g.setStyle("margin-bottom",k+a.verticalUnit):g.removeStyle("margin-bottom");""!=c?g.setStyle("margin-left",c+a.verticalUnit):g.removeStyle("margin-left");""!=f?g.setStyle("margin-right",f+a.verticalUnit):g.removeStyle("margin-right");var w=0,q="";p==a.paragraph.firstLine.indent?q=r+a.verticalUnit:p==a.paragraph.firstLine.outdent&&(w=parseFloat(r),q="-"+w+a.verticalUnit);0==q.length?g.removeStyle("text-indent"):
g.setStyle("text-indent",q);isNaN(w)||0==w||g.setStyle("margin-left",parseFloat(c)+w+a.verticalUnit);g&&(["top","right","bottom","left"].forEach(function(a){-1==d.enableBorderEdges.indexOf(a)?(g.removeStyle("border-"+a+"-color"),g.removeStyle("border-"+a+"-style"),g.removeStyle("border-"+a+"-width")):(g.setStyle("border-"+a+"-color",l),g.setStyle("border-"+a+"-style",u),g.setStyle("border-"+a+"-width",t))}),m?g.setStyle("background-color",m):g.removeStyle("background-color"))}}POLARIS.tools.setTimeout(function(){if(y)for(var a=
0;a<y.length;a++){var c=y[a];if(c.getState()==POLARIS.TRISTATE_ON){b.execCommand(c.name);break}}b.fire("saveSnapshot")},0,this)}}})})();