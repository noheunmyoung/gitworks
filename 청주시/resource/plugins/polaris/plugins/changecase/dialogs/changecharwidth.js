(function(){POLARIS.dialog.add("changecharwidth",function(l){var e=l.lang.changecase,n=function(a){if(12593<=a&&12622>=a)return a+52848;if(12623==a)return 65474;if(12624==a)return 65475;if(12625==a)return 65476;if(12626==a)return 65477;if(12627==a)return 65478;if(12628==a)return 65479;if(12629==a)return 65482;if(12630==a)return 65483;if(12631==a)return 65484;if(12632==a)return 65485;if(12633==a)return 65486;if(12634==a)return 65487;if(12635==a)return 65490;if(12636==a)return 65491;if(12637==a)return 65492;
if(12638==a)return 65493;if(12639==a)return 65494;if(12640==a)return 65495;if(12641==a)return 65498;if(12642==a)return 65499;if(12643==a)return 65500},q=function(a){if(65441<=a&&65470>=a)return a-52848;if(65474==a)return 12623;if(65475==a)return 12624;if(65476==a)return 12625;if(65477==a)return 12626;if(65478==a)return 12627;if(65479==a)return 12628;if(65482==a)return 12629;if(65483==a)return 12630;if(65484==a)return 12631;if(65485==a)return 12632;if(65486==a)return 12633;if(65487==a)return 12634;
if(65490==a)return 12635;if(65491==a)return 12636;if(65492==a)return 12637;if(65493==a)return 12638;if(65494==a)return 12639;if(65495==a)return 12640;if(65498==a)return 12641;if(65499==a)return 12642;if(65500==a)return 12643},r=function(a){switch(a){case 12449:a=65383;break;case 12450:a=65393;break;case 12451:a=65384;break;case 12452:a=65394;break;case 12453:a=65385;break;case 12454:a=65395;break;case 12455:a=65386;break;case 12456:a=65396;break;case 12457:a=65387;break;case 12458:a=65397;break;case 12459:a=
65398;break;case 12461:a=65399;break;case 12463:a=65400;break;case 12465:a=65401;break;case 12467:a=65402;break;case 12469:a=65403;break;case 12471:a=65404;break;case 12473:a=65405;break;case 12475:a=65406;break;case 12477:a=65407;break;case 12479:a=65408;break;case 12481:a=65409;break;case 12483:a=65391;break;case 12484:a=65410;break;case 12486:a=65411;break;case 12488:a=65412;break;case 12490:a=65413;break;case 12491:a=65414;break;case 12492:a=65415;break;case 12493:a=65416;break;case 12494:a=65417;
break;case 12495:a=65418;break;case 12498:a=65419;break;case 12501:a=65420;break;case 12504:a=65421;break;case 12507:a=65422;break;case 12510:a=65423;break;case 12511:a=65424;break;case 12512:a=65425;break;case 12513:a=65426;break;case 12514:a=65427;break;case 12515:a=65388;break;case 12516:a=65428;break;case 12517:a=65389;break;case 12518:a=65429;break;case 12519:a=65390;break;case 12520:a=65430;break;case 12521:a=65431;break;case 12522:a=65432;break;case 12523:a=65433;break;case 12524:a=65434;break;
case 12525:a=65435;break;case 12527:a=65436;break;case 12530:a=65382;break;case 12531:a=65437;break;case 12539:a=65381;break}return a},t=function(a,e,f,l,h,k){if(!(a.type!=POLARIS.NODE_TEXT||a.getLength()<h)){void 0==l&&(l=0);void 0==h&&(h=0);k=a.getText();for(var g="",m=0;m<a.getLength();m++)if(m<l||m>=h)g+=k.charAt(m);else{var c=k.charCodeAt(m);if("toHalf"==e){var d;if(d=f&1)d=65296<=c&&65305>=c?!0:!1;if(d)g+=String.fromCharCode(c-65248);else{if(d=f&2)d=65313<=c&&65338>=c||65345<=c&&65370>=c?!0:
!1;if(d)g+=String.fromCharCode(c-65248);else{if(d=f&4)d=65281<=c&&65295>=c||65306<=c&&65312>=c||65339<=c&&65344>=c||65371<=c&&65374>=c?!0:!1;if(d)g+=String.fromCharCode(c-65248);else{if(d=f&8)d=12593<=c&&12643>=c?!0:!1;if(d)g+=String.fromCharCode(n(c));else{if(d=f&16)d=12449<=c&&12539>=c?!0:!1;g=d?g+String.fromCharCode(r(c)):g+k.charAt(m)}}}}}else if("toFull"==e){if(d=f&1)d=48<=c&&57>=c?!0:!1;if(d)g+=unescape("%u"+(c+65248).toString(16));else{if(d=f&2)d=65<=c&&90>=c||97<=c&&122>=c?!0:!1;if(d)g+=unescape("%u"+
(c+65248).toString(16));else{if(d=f&4)d=33<=c&&47>=c||58<=c&&64>=c||91<=c&&96>=c||123<=c&&126>=c?!0:!1;if(d)g+=unescape("%u"+(c+65248).toString(16));else{if(d=f&8)d=65441<=c&&65499>=c?!0:!1;if(d)g+=unescape("%u"+q(c).toString(16));else{if(d=f&16)d=65381<=c&&65437>=c?!0:!1;if(d){d=unescape;var b=void 0;switch(c){case 65383:b=12449;break;case 65393:b=12450;break;case 65384:b=12451;break;case 65394:b=12452;break;case 65385:b=12453;break;case 65395:b=12454;break;case 65386:case 65396:b=12456;break;case 65387:b=
12457;break;case 65397:b=12458;break;case 65398:b=12459;break;case 65399:b=12461;break;case 65400:b=12463;break;case 65401:b=12465;break;case 65402:b=12467;break;case 65403:b=12469;break;case 65404:b=12471;break;case 65405:b=12473;break;case 65406:b=12475;break;case 65407:b=12477;break;case 65408:b=12479;break;case 65409:b=12481;break;case 65391:b=12483;break;case 65410:b=12484;break;case 65411:b=12486;break;case 65412:b=12488;break;case 65413:b=12490;break;case 65414:b=12491;break;case 65415:b=12492;
break;case 65416:b=12493;break;case 65417:b=12494;break;case 65418:b=12495;break;case 65419:b=12498;break;case 65420:b=12501;break;case 65421:b=12504;break;case 65422:b=12507;break;case 65423:b=12510;break;case 65424:b=12511;break;case 65425:b=12512;break;case 65426:b=12513;break;case 65427:b=12514;break;case 65388:b=12515;break;case 65428:b=12516;break;case 65389:b=12517;break;case 65429:b=12518;break;case 65390:b=12519;break;case 65430:b=12520;break;case 65431:b=12521;break;case 65432:b=12522;break;
case 65433:b=12523;break;case 65434:b=12524;break;case 65435:b=12525;break;case 65436:b=12527;break;case 65382:b=12530;break;case 65437:b=12531;break;case 65381:b=12539;break;default:b=c}g+=d("%u"+b.toString(16))}else g+=k.charAt(m)}}}}}}a.setText(g);return a}};return{title:e.changeCharWidth,minWidth:244,minHeight:40,resizable:POLARIS.DIALOG_RESIZE_NONE,contents:[{id:"info",label:e.changeCharWidth,title:e.changeCharWidth,elements:[{type:"vbox",children:[{type:"fieldset",label:e.changeCharOption,children:[]},
{id:"changeWidthOptions",title:e.changeCharOption,type:"radio",order:"vertical","default":"toFull",className:"vertical-radio-group",items:[[e.toFull,"toFull"],[e.toHalf,"toHalf"]]},{type:"fieldset",label:e.changeCharType.title,children:[]},{type:"vbox",className:"vertical-checkbox-table",children:[{id:"checkChangeTypeNumber",type:"checkbox","default":!0,label:e.changeCharType.number},{id:"checkChangeTypeEnglish",type:"checkbox","default":!0,label:e.changeCharType.english},{id:"checkChangeTypeSymbol",
type:"checkbox","default":!0,label:e.changeCharType.symbol},{id:"checkChangeTypeKorean",type:"checkbox","default":!0,label:e.changeCharType.korean},{id:"checkChangeTypeKatakana",type:"checkbox","default":!0,label:e.changeCharType.katakana}]},{type:"html",html:'\x3cdiv style\x3d"height:5px"\x3e\x3c/div\x3e'}]}]}],onOk:function(){var a=l.getSelection().getRanges()[0],e=l.plugins.tablecellblock,f=[];e&&e.isSelected()&&(f=e.getSelectedCells());if(!a.collapsed||f.length){var n=this.getContentElement("info",
"changeWidthOptions").getValue(),h=0;this.getContentElement("info","checkChangeTypeNumber").getValue()&&(h|=1);this.getContentElement("info","checkChangeTypeEnglish").getValue()&&(h|=2);this.getContentElement("info","checkChangeTypeSymbol").getValue()&&(h|=4);this.getContentElement("info","checkChangeTypeKorean").getValue()&&(h|=8);this.getContentElement("info","checkChangeTypeKatakana").getValue()&&(h|=16);e=function(a){var e,c,d=[],b,f=new POLARIS.dom.walker(a);f.breakOnFalse=1;for(f.evaluator=
function(a){return a.type==POLARIS.NODE_TEXT&&0<a.getLength()&&!a.isReadOnly()};b=f.next();)d.push(b);for(b=0;b<d.length;b++){var k=d[b],f=0,p=k.getLength();0==b&&a.startContainer.type==POLARIS.NODE_TEXT&&(f=a.startOffset);b==d.length-1&&a.endContainer.type==POLARIS.NODE_TEXT&&(p=a.endOffset);k=t(k,n,h,f,p,l);0==b&&(e={node:k,startOffset:f});b==d.length-1&&(c={node:k,endOffset:p})}return{rangeStart:e,rangeEnd:c}};if(a.collapsed)for(var k=0;k<f.length;k++)a.selectNodeContents(f[k]),e(a);else f=e(a),
e=new POLARIS.dom.range(l.document),e.setStart(f.rangeStart.node,f.rangeStart.startOffset),e.setEnd(f.rangeEnd.node,f.rangeEnd.endOffset),a.select()}}}})})();