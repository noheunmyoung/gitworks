(function(){POLARIS.dialog.add("changecase",function(k){var g=k.lang.changecase,n=function(b,g,a,e,d){if(!(b.type!=POLARIS.NODE_TEXT||b.getLength()<e)){void 0==a&&(a=0);void 0==e&&(e=0);d=b.getText();for(var c="",h=0;h<b.getLength();h++)if(h<a||h>=e)c+=d.charAt(h);else{var f=d.charCodeAt(h);"upper"==g?c=97<=f&&122>=f?c+String.fromCharCode(f-32):c+d.charAt(h):"lower"==g?c=65<=f&&90>=f?c+String.fromCharCode(f+32):c+d.charAt(h):"upperAndLower"==g&&(c=97<=f&&122>=f?c+String.fromCharCode(f-32):65<=f&&
90>=f?c+String.fromCharCode(f+32):c+d.charAt(h))}b.setText(c);return b}};return{title:g.changeCase,minWidth:244,minHeight:40,resizable:POLARIS.DIALOG_RESIZE_NONE,contents:[{id:"info",label:g.changeCase,title:g.changeCase,elements:[{id:"caseOptions",label:g.ratio,title:g.ratio,type:"radio",order:"vertical","default":"upper",className:"vertical-radio-group",items:[[g.toUppercase,"upper"],[g.toLowercase,"lower"],[g.toUpperAndLowercase,"upperAndLower"]]},{type:"html",html:'\x3cdiv style\x3d"height:5px"\x3e\x3c/div\x3e'}]}],
onOk:function(){var b=k.getSelection().getRanges()[0],g=this.getContentElement("info","caseOptions").getValue(),a=k.plugins.tablecellblock,e=[];a&&a.isSelected()&&(e=a.getSelectedCells());if(!b.collapsed||e.length)if(a=function(c){var e,f,b=[],a,d=new POLARIS.dom.walker(c);d.breakOnFalse=1;for(d.evaluator=function(a){return a.type==POLARIS.NODE_TEXT&&0<a.getLength()&&!a.isReadOnly()};a=d.next();)b.push(a);for(a=0;a<b.length;a++){var l=b[a],d=0,m=l.getLength();0==a&&c.startContainer.type==POLARIS.NODE_TEXT&&
(d=c.startOffset);a==b.length-1&&c.endContainer.type==POLARIS.NODE_TEXT&&(m=c.endOffset);l=n(l,g,d,m,k);0==a&&(e={node:l,startOffset:d});a==b.length-1&&(f={node:l,endOffset:m})}return{rangeStart:e,rangeEnd:f}},b.collapsed)for(var d=0;d<e.length;d++)b.selectNodeContents(e[d]),a(b);else e=a(b),a=new POLARIS.dom.range(k.document),a.setStart(e.rangeStart.node,e.rangeStart.startOffset),a.setEnd(e.rangeEnd.node,e.rangeEnd.endOffset),b.select()}}})})();