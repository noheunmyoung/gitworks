function _typeof(C){"@babel/helpers - typeof";_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(u){return typeof u}:function(u){return u&&"function"===typeof Symbol&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u};return _typeof(C)}
(function(){function C(a){a=a.toUpperCase();for(var b=E.length,c=0,f=0;f<b;++f)for(var d=E[f],e=d[1].length;a.substr(0,e)==d[1];a=a.substr(e))c+=d[0];return c}function u(a){a=a.toUpperCase();for(var b=1,c=1;0<a.length;c*=26)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(a.length-1))*c,a=a.substr(0,a.length-1);return b}var F=POLARIS.htmlParser.fragment.prototype,x=POLARIS.htmlParser.element.prototype;F.onlyChild=x.onlyChild=function(){var a=this.children;return 1==a.length&&a[0]||null};x.removeAnyChildWithName=
function(a){for(var b=this.children,c=[],f,d=0;d<b.length;d++)f=b[d],f.name&&(f.name==a&&(c.push(f),b.splice(d--,1)),c=c.concat(f.removeAnyChildWithName(a)));return c};x.getAncestor=function(a){for(var b=this.parent;b&&(!b.name||!b.name.match(a));)b=b.parent;return b};F.firstChild=x.firstChild=function(a){for(var b,c=0;c<this.children.length;c++)if(b=this.children[c],a(b)||b.name&&(b=b.firstChild(a)))return b;return null};x.addStyle=function(a,b,c){var f="";if("string"==typeof b)f+=a+":"+b+";";else{if("object"==
_typeof(a))for(var d in a)a.hasOwnProperty(d)&&(f+=d+":"+a[d]+";");else f+=a;c=b}this.attributes||(this.attributes={});a=this.attributes.style||"";a=(c?[f,a]:[a,f]).join(";");this.attributes.style=a.replace(/^;+|;(?=;)/g,"")};x.getStyle=function(a){var b=this.attributes.style;if(b)return b=POLARIS.tools.parseCssText(b,1),b[a]};POLARIS.dtd.parentOf=function(a){var b={},c;for(c in this)-1==c.indexOf("$")&&this[c][a]&&(b[c]=1);return b};var K=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i,
G=/^(?:\b0[^\s]*\s*){1,4}$/,D={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},E=[[1E3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],A=0,q=null,B,H=POLARIS.plugins.pastefromword={utils:{createListBulletMarker:function(a,
b){var c=new POLARIS.htmlParser.element("polaris:listbullet");c.attributes={"polaris:listsymbol":a[0]};c.add(new POLARIS.htmlParser.text(b));return c},isListBulletIndicator:function(a){if(/mso-list\s*:\s*Ignore/i.test(a.attributes&&a.attributes.style))return!0},isContainingOnlySpaces:function(a){var b;return(b=a.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(b.value)},resolveList:function(a){var b=a.attributes,c;if((c=a.removeAnyChildWithName("polaris:listbullet"))&&c.length&&(c=c[0]))return a.name="polaris:li",
b.style&&(b.style=H.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(a){a=a.split(" ");a=POLARIS.tools.convertToPx(a[3]||a[1]||a[0]);!A&&null!==q&&a>q&&(A=a-q);q=a;b["polaris:indent"]=A&&Math.ceil(a/A)+1||1}],[/^mso-list$/,null,function(a){a=a.split(" ");var c=Number(a[0].match(/\d+/));a=Number(a[1].match(/\d+/));1==a&&(c!==B&&(b["polaris:reset"]=1),B=c);b["polaris:indent"]=a}]])(b.style,a)||""),b["polaris:indent"]||(q=0,b["polaris:indent"]=1),POLARIS.tools.extend(b,
c.attributes),!0;B=q=A=null;return!1},getStyleComponents:function(){var a=POLARIS.dom.element.createFromHtml('\x3cdiv style\x3d"position:absolute;left:-9999px;top:-9999px;"\x3e\x3c/div\x3e',POLARIS.document);POLARIS.document.getBody().append(a);return function(b,c,f){a.setStyle(b,c);b={};c=f.length;for(var d=0;d<c;d++)b[f[d]]=a.getStyle(f[d]);return b}}(),listDtdParents:POLARIS.dtd.parentOf("ol")},filters:{flattenList:function(a,b){b="number"==typeof b?b:1;var c=a.attributes,f;switch(c.type){case "a":f=
"lower-alpha";break;case "1":f="decimal"}for(var d=a.children,e,h=0;h<d.length;h++)if(e=d[h],e.name in POLARIS.dtd.$listItem){var l=e.attributes,g=e.children,p=g[g.length-1];p.name in POLARIS.dtd.$list&&(a.add(p,h+1),--g.length||d.splice(h--,1));e.name="polaris:li";c.start&&!h&&(l.value=c.start);H.filters.stylesFilter([["tab-stops",null,function(a){(a=a.split(" ")[1].match(K))&&(q=POLARIS.tools.convertToPx(a[0]))}],1==b?["mso-list",null,function(a){a=a.split(" ");a=Number(a[0].match(/\d+/));a!==B&&
(l["polaris:reset"]=1);B=a}]:null])(l.style);l["polaris:indent"]=b;l["polaris:listtype"]=a.name;l["polaris:list-style-type"]=f}else if(e.name in POLARIS.dtd.$list){arguments.callee.apply(this,[e,b+1]);d=d.slice(0,h).concat(e.children).concat(d.slice(h+1));a.children=[];e=0;for(g=d.length;e<g;e++)a.add(d[e]);d=a.children}delete a.name;c["polaris:list"]=1},assembleList:function(a){var b=a.children,c,f,d,e,h,l;a=[];for(var g,p,k,n,m,t,r=0;r<b.length;r++)if(c=b[r],"polaris:li"==c.name)if(c.name="li",
f=c.attributes,k=(k=f["polaris:listsymbol"])&&k.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),n=m=t=null,f["polaris:ignored"])b.splice(r--,1);else{f["polaris:reset"]&&(l=e=h=null);d=Number(f["polaris:indent"]);d!=e&&(p=g=null);if(k){if(p&&D[p][g].test(k[1]))n=p,m=g;else for(var v in D)for(var y in D[v])if(D[v][y].test(k[1]))if("ol"==v&&/alpha|roman/.test(y)){if(g=/roman/.test(y)?C(k[1]):u(k[1]),!t||g<t)t=g,n=v,m=y}else{n=v;m=y;break}!n&&(n=k[2]?"ol":"ul")}else n=f["polaris:listtype"]||"ol",m=f["polaris:list-style-type"];
p=n;g=m||("ol"==n?"decimal":"disc");m&&m!=("ol"==n?"decimal":"disc")&&c.addStyle("list-style-type",m);if("ol"==n&&k){switch(m){case "decimal":t=Number(k[1]);break;case "lower-roman":case "upper-roman":t=C(k[1]);break;case "lower-alpha":case "upper-alpha":t=u(k[1])}c.attributes.value=t}if(l){if(d>e)a.push(l=new POLARIS.htmlParser.element(n)),l.add(c),h.add(l);else{if(d<e){e-=d;for(var w;e--&&(w=l.parent);)l=w.parent}l.add(c)}b.splice(r--,1)}else a.push(l=new POLARIS.htmlParser.element(n)),l.add(c),
b[r]=l;h=c;e=d}else l&&(l=e=h=null);for(r=0;r<a.length;r++)if(l=a[r],v=l.children,g=g=void 0,y=l.children.length,w=g=void 0,b=/list-style-type:(.*?)(?:;|$)/,e=POLARIS.plugins.pastefromword.filters.stylesFilter,g=l.attributes,!b.exec(g.style)){for(h=0;h<y;h++)if(g=v[h],g.attributes.value&&Number(g.attributes.value)==h+1&&delete g.attributes.value,g=b.exec(g.attributes.style))if(g[1]!=w&&w){w=null;break}else w=g[1];if(w){for(h=0;h<y;h++)g=v[h].attributes,g.style&&(g.style=e([["list-style-type"]])(g.style)||
"");l.addStyle("list-style-type",w)}}B=q=A=null},falsyFilter:function(){return!1},stylesFilter:function(a,b){return function(c,f){var d=[];(c||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(c,e,g){e=e.toLowerCase();"font-family"==e&&(g=g.replace(/["']/g,""));for(var p,k,n,m=0;m<a.length;m++)if(a[m]&&(c=a[m][0],p=a[m][1],k=a[m][2],n=a[m][3],e.match(c)&&(!p||g.match(p)))){e=n||e;b&&(k=k||g);"function"==typeof k&&(k=k(g,f,e));k&&k.push&&(e=k[0],k=k[1]);"string"==
typeof k&&d.push([e,k]);return}!b&&d.push([e,g])});for(var e=0;e<d.length;e++)d[e]=d[e].join(":");return d.length?d.join(";")+";":!1}},elementMigrateFilter:function(a,b){return a?function(c){var f=b?(new POLARIS.style(a,b))._.definition:a;c.name=f.element;POLARIS.tools.extend(c.attributes,POLARIS.tools.clone(f.attributes));c.addStyle(POLARIS.style.getStyleText(f))}:function(){}},styleMigrateFilter:function(a,b){var c=this.elementMigrateFilter;return a?function(f,d){var e=new POLARIS.htmlParser.element(null),
h={};h[b]=f;c(a,h)(e);e.children=d.children;d.children=[e];e.filter=function(){};e.parent=d}:function(){}},bogusAttrFilter:function(a,b){if(-1==b.name.indexOf("polaris:"))return!1},applyStyleFilter:null},getRules:function(a,b){var c=POLARIS.dtd,f=POLARIS.tools.extend({},c.$block,c.$listItem,c.$tableContent),d=a.config,e=this.filters,h=e.falsyFilter,l=e.stylesFilter,g=e.elementMigrateFilter,p=POLARIS.tools.bind(this.filters.styleMigrateFilter,this.filters),k=this.utils.createListBulletMarker,n=e.flattenList,
m=e.assembleList,t=this.utils.isListBulletIndicator,r=this.utils.isContainingOnlySpaces,v=this.utils.resolveList,y=function(a){a=POLARIS.tools.convertToPx(a);return isNaN(a)?a:a+"px"},w=this.utils.getStyleComponents,u=this.utils.listDtdParents,q=!1!==d.pasteFromWordRemoveFontStyles,x=!1!==d.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(a){a.filterChildren(b);m(a)},elements:{"^":function(a){var b;POLARIS.env.gecko&&(b=e.applyStyleFilter)&&b(a)},$:function(a){var z=
a.name||"",e=a.attributes;z in f&&e.style&&(e.style=l([[/^(:?width|height)$/,null,y]])(e.style)||"");if(z.match(/h\d/)){a.filterChildren(b);if(v(a))return;g(d["format_"+z])(a)}else if(z in c.$inline)a.filterChildren(b),r(a)&&delete a.name;else if(-1!=z.indexOf(":")&&-1==z.indexOf("cke")){a.filterChildren(b);if("v:imagedata"==z){if(z=a.attributes["o:href"])a.attributes.src=z;a.name="img";return}a.name.indexOf("polaris:")&&delete a.name}z in u&&(a.filterChildren(b),m(a))},style:function(a){if(POLARIS.env.gecko){a=
(a=a.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&a[1];var b={};a&&(a.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(a,c,I){c=c.split(",");a=c.length;for(var d=0;d<a;d++)POLARIS.tools.trim(c[d]).replace(/^(\w+)(\.[\w-]+)?$/g,function(a,c,d){c=c||"*";d=d.substring(1,d.length);d.match(/MsoNormal/)||(b[c]||(b[c]={}),d?b[c][d]=I:b[c]=I)})}),e.applyStyleFilter=function(a){var c=b["*"]?"*":a.name,d=a.attributes&&a.attributes["class"];c in b&&(c=b[c],"object"==_typeof(c)&&
(c=c[d]),c&&a.addStyle(c,!0))})}return!1},p:function(a){(/MsoListParagraph/i.exec(a.attributes["class"])||a.getStyle("mso-list"))&&a.firstChild(function(a){return a.type==POLARIS.NODE_TEXT&&!r(a.parent)});a.filterChildren(b);v(a)||(d.enterMode==POLARIS.ENTER_BR?(delete a.name,a.add(new POLARIS.htmlParser.element("br"))):g(d["format_"+(d.enterMode==POLARIS.ENTER_P?"p":"div")])(a))},div:function(a){var b=a.onlyChild();if(b&&"table"==b.name){var c=a.attributes;b.attributes=POLARIS.tools.extend(b.attributes,
c);c.style&&b.addStyle(c.style);b=new POLARIS.htmlParser.element("div");b.addStyle("clear","both");a.add(b);delete a.name}},td:function(a){a.getAncestor("thead")&&(a.name="th")},ol:n,ul:n,dl:n,font:function(a){if(t(a.parent))delete a.name;else{a.filterChildren(b);var c=a.attributes,d=c.style,e=a.parent;"font"==e.name||"p"==e.name?(POLARIS.tools.extend(e.attributes,a.attributes),d&&e.addStyle(d),delete a.name):(d=(d||"").split(";"),c.color&&("#000000"!=c.color&&d.push("color:"+c.color),delete c.color),
c.face&&(d.push("font-family:"+c.face),delete c.face),a.addStyle(d.join(";")))}},span:function(a){if(t(a.parent)&&!POLARIS.env.ie)return!1;a.filterChildren(b);if(r(a))return delete a.name,null;if(t(a)){var c=a.firstChild(function(a){return a.value||"img"==a.name}),e=(c=c&&(c.value||"l."))&&c.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),f=a.attributes,g=f&&f.style;if(-1==g.indexOf("mso-ascii-font-family")&&e)return c=k(e,c),(a=a.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(a.attributes.style)&&
(c.attributes["polaris:ignored"]=1),c}if(g=(f=a.attributes)&&f.style)f.style=l([["line-height"],[/^mso-fareast-font-family$/,null,q?null:p(d.font_style,"family")],[/^font-family$/,null,q?null:p(d.font_style,"family")],[/^font-size$/,null,q?null:p(d.fontSize_style,"size")],[/^color$/,null,q?null:p(d.colorButton_foreStyle,"color")],[/^background-color$/,null,q?null:p(d.colorButton_backStyle,"color")]])(g,a)||"";f.style||delete f.style;POLARIS.tools.isEmpty(f)&&delete a.name;return null},b:g(d.coreStyles_bold),
i:g(d.coreStyles_italic),u:g(d.coreStyles_underline),s:g(d.coreStyles_strike),sup:g(d.coreStyles_superscript),sub:g(d.coreStyles_subscript),a:function(a){a=a.attributes;a.href&&a.href.match(/^file:\/\/\/[\S]+#/i)&&(a.href=a.href.replace(/^file:\/\/\/[^#]+/i,""))},"polaris:listbullet":function(a){a.getAncestor(/h\d/)&&!d.pasteFromWordNumberedHeadingToList&&delete a.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:l(x?[[/^list-style-type$/,
null],[/^margin$|^margin-(?!bottom|top)/,null,function(a,c,b){if(c.name in{p:1,div:1}){c="ltr"==d.contentsLangDirection?"margin-left":"margin-right";if("margin"==b)a=w(b,a,[c])[c];else if(b!=c)return null;if(a&&!G.test(a))return[c,a]}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(a,c){if("img"==c.name)return a}],[/^width|height|background$/,null,function(a,c){if(c.name in{table:1,td:1,th:1,img:1})return a}]]:[[/^mso-/],[/-color$/,null,function(a){return"transparent"==
a?!1:a}],[/^margin$/,G],["text-indent","0cm"],["page-break-before"],["tab-stops"],q?[/font-?/]:null],x),width:function(a,b){if(b.name in c.$tableContent)return!1},border:function(a,b){if(b.name in c.$tableContent)return!1},"class":h,bgcolor:h,valign:x?h:function(a,c){c.addStyle("vertical-align",a);return!1}},comment:POLARIS.env.ie?h:function(a,c){var b=a.match(/<img.*?>/),d=a.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return d?(d=(b=d[1]||b&&"l.")&&b.match(/>(?:[(]?)([^\s]+?)([.)]?)</),k(d,
b)):POLARIS.env.gecko&&b?(b=POLARIS.htmlParser.fragment.fromHtml(b[0]).children[0],(d=(d=(d=c.previous)&&d.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&d[1])&&(b.attributes.src=d),b):!1}}}},J=function(){this.dataFilter=new POLARIS.htmlParser.filter};J.prototype={toHtml:function(a){a=POLARIS.htmlParser.fragment.fromHtml(a,null,!1,!0);var b=new POLARIS.htmlParser.basicWriter;a.writeHtml(b,this.dataFilter);return b.getHtml(!0)}};POLARIS.cleanWord=function(a,b){POLARIS.env.gecko&&(a=a.replace(/(\x3c!--\[if[^<]*?\])--\x3e([\S\s]*?)\x3c!--(\[endif\]--\x3e)/gi,
"$1$2$3"));POLARIS.env.webkit&&(a=a.replace(/(class="MsoListParagraph[^>]+>\x3c!--\[if !supportLists\]--\x3e)([^<]+<span[^<]+<\/span>)(\x3c!--\[endif\]--\x3e)/gi,"$1\x3cspan\x3e$2\x3c/span\x3e$3"));var c=new J,f=c.dataFilter;f.addRules(POLARIS.plugins.pastefromword.getRules(b,f));b.fire("beforeCleanWord",{filter:f});try{a=c.toHtml(a)}catch(d){alert(b.lang.pastefromword.error)}a=a.replace(/polaris:.*?".*?"/g,"");a=a.replace(/style=""/g,"");return a=a.replace(/<span>/g,"")}})();