POLARIS.dialog.add("clickhere",function(b){function k(a){return a.type==POLARIS.NODE_ELEMENT&&a.hasAttribute("doc-data-field")&&!a.is("td")}var l=b.lang.table,m=l.cell;return{title:b.lang.clickhere.label,minWidth:264,minHeight:80,resizable:POLARIS.DIALOG_RESIZE_NONE,contents:[{id:"info",label:b.lang.common.generalTab,accessKey:"I",elements:[{type:"text",id:"cellField",width:"100%",label:m.cellField,"default":"",maxLength:100,setup:function(a){1!=b.config.editMode&&this.disable();a&&(a=a.getAttribute("doc-data-field"),
this.setValue(a))},commit:function(a){if(0!=this.isChanged()&&0!=this.isEnabled()){var b=this.getValue();null==b||0==b.length?(a.removeAttribute("doc-data-field"),a.removeAttribute("contentEditable")):a.setAttribute("doc-data-field",this.getValue())}}},{type:"html",html:""},{type:"checkbox",id:"cellFieldEditable",width:"100%",label:m.cellFieldEditable,"default":!1,validate:function(){if(1==this.getValue()){var a=this.getDialog().getContentElement("info","cellField").getValue();a&&(a=a.replace(/^\s+|\s+$/gm,
""));if(""==a)return alert(l.noFieldNameForFieldEditable),!1}return!0},setup:function(a){1!=b.config.editMode&&this.disable();a&&"true"==a.getAttribute("doc-data-field-editable")?this.setValue(!0):this.setValue(!1)},commit:function(a){0!=this.isChanged()&&0!=this.isEnabled()&&(0==a.hasAttribute("doc-data-field")?a.removeAttribute("doc-data-field-editable"):this.getValue()?a.setAttribute("doc-data-field-editable",!0):a.setAttribute("doc-data-field-editable",!1))}},{type:"html",html:'\x3cdiv style\x3d"height: 6px;"\x3e\x3c/div\x3e'}]}],
onShow:function(){var a=b.getSelection(),a=(a=a&&a.getStartElement())&&a.getAscendant(k,!0);this.setupContent(a)},onOk:function(){var a=b.getSelection(),d=(a=a&&a.getStartElement())&&a.getAscendant(k,!0);if(null!=a)if(d)this.commitContent(d);else{var c=this.getContentElement("info","cellField").getValue(),e=this.getContentElement("info","cellFieldEditable").getValue();if(a.getAscendant("td"))alert(b.lang.clickhere.cannotInsertClickHere);else if(!c||1>c.length)alert(b.lang.clickhere.insertFieldName);
else{d=new POLARIS.dom.element(POLARIS.env.ie&&8>=POLARIS.env.version?"div":"article");d.setAttribute("doc-data-field",c);d.setAttribute("doc-data-field-editable",e);d.setAttribute("doc-data-field-position","both");1==b.config.editMode&&d.addClass("polarisClickHere");POLARIS.env.ie&&d.setStyle("ime-mode","active");var c=a.getStyle("line-height"),e=a.getStyle("font-family"),f=a.getStyle("font-size");if(null==c||0==c.length)c=1.6;null!=e&&0!=e.length||!b.config.documentFontFamily||(e=b.config.documentFontFamily);
null!=f&&0!=f.length||!b.config.documentFontSize||(f=b.config.documentFontSize+"pt");null!=c&&0!=c.length||!b.config.documentLineHeight||(c=b.config.documentLineHeight);var g=new POLARIS.dom.element("p"),h=new POLARIS.dom.element("span");g.append(h);g.setStyles({"line-height":c,"font-size":f});h.setStyles({"font-family":e,"font-size":f});h.setHtml("\x26#8203;");d.append(g);c=a.getAscendant("td td",!0);a=a.getAscendant("p",!0);c&&null==a?c.appendChild(d):a&&(d.insertAfter(a),(new POLARIS.dom.element.createFromHtml(html)).insertAfter(d))}}}}});