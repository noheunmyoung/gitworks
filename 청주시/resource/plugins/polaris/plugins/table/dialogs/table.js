(function(){function x(a,b,g){var d=a.getStyle("width");g=!g&&d.replace(/[0-9|.]/g,"");var h=0;"mm"==b?"mm"==g?h=parseInt(d.replace(/[^0-9|.]/g,"")):(h=POLARIS.env.ie?a.$.clientWidth:parseFloat(a.getComputedStyle("width")),h=parseInt(POLARIS.tools.convertPxToMm(h))):"px"==b&&(h="px"==g?parseFloat(d.replace(/[^0-9|.]/g,"")):POLARIS.env.ie?a.$.clientWidth:parseFloat(a.getComputedStyle("width")));return h}function z(a){var b=a.getSelection().getStartElement();if(b){var g=a.elementPath(b);a=POLARIS.tools.getContentSizeToUnit(a,
"mm").width;g&&(b=g.blockLimit||g.block||b);b=POLARIS.tools.convertPxToMm(b.getSize("width",!0));b=parseInt(b);b>=a&&(b=a-1);return b}}function A(a){for(var b=0,g=0,d=0,h,q=a.$.rows.length;d<q;d++){h=a.$.rows[d];for(var r=b=0,f,e=h.cells.length;r<e;r++)f=h.cells[r],/polaris_dummy_cell/.test(f.className)||(b+=f.colSpan);b>g&&(g=b)}return g}function v(a,b,g){return function(){var d=this.getValue(),d=!!(POLARIS.dialog.validate.number()(d)&&d>=b&&d<g+1);d||(alert(a.replace("%1",g)),this.select());return d}}
function y(a,b){if(a)for(var g=a.elements,d=0,h;d<g.length;d++)if(h=g[d],h=h.getStyle(b))return h;return null}function t(a,b){var g=function(f){return new POLARIS.dom.element(f,a.document)};a.editable();var d={type:"html",html:"\x26nbsp;"},h=a.plugins.uicolor;setupData={};setupData.info||(setupData.info={});var t=POLARIS.tools.getNextId()+"_tableBgColorPanel",r=POLARIS.tools.getNextId()+"_tableBorderColorPanel";return{title:a.lang.table.title,minWidth:282,minHeight:120,resizable:POLARIS.DIALOG_RESIZE_NONE,
onLoad:function(){var a=this,e=a.getContentElement("advanced","advStyles");if(e)e.on("change",function(){var c=this.getStyle("width",""),e=a.getContentElement("info","txtWidth");e&&e.setValue(c,!0)})},onShow:function(){a.pagination&&a.pagination.adjustCaret(a);var f=a.getSelection(),e=f.getRanges(),c,m=this.getContentElement("info","txtRows"),g=this.getContentElement("info","txtCols"),l=this.getContentElement("info","txtWidth");if("tableProperties"==b){if((f=f.getSelectedElement())&&f.is("table")?
c=f:0<e.length&&(POLARIS.env.webkit&&e[0].shrink(POLARIS.NODE_ELEMENT),c=a.elementPath(e[0].getCommonAncestor(!0)).contains("table",1)),null==c&&(c=POLARIS.plugins.tabletools.getFocusedTable(a)),this._.selectedElement=c,this._.paginatedTables=null,e=c.getAttribute("data-split-id"),!POLARIS.tools.isEmptyValue(e)){this._.paginatedTables=[];var e=c.getAscendant("body",1).find('table[data-split-id\x3d"'+e+'"]'),d,f=0;for(d=e.count();f<d;f++)this._.paginatedTables.push(e.getItem(f))}}else l.setValue(z(a));
c?(this.setupContent(c),m&&m.disable(),g&&g.disable()):(m&&m.enable(),g&&g.enable());l&&l.onChange()},onOk:function(){var f=a.plugins.tablecellblock;f&&f.clearCellBlock(a);a.pagination&&a.pagination.adjustCaret(a);if(!POLARIS.plugins.div.getSurroundDiv(a)){var f=a.getSelection(),e=this._.selectedElement&&f.createBookmarks(),c=this._.selectedElement||g("table"),m=this._.paginatedTables,b={};c.setStyle("table-layout","fixed");this.commitContent(b,c);if(b.info){b=b.info;0<parseFloat(b.cmbCellSpacing)?
(c.setStyle("border-spacing",parseFloat(b.cmbCellSpacing)+a.lang.common.unitPt),c.setStyle("border-collapse","separate")):(c.setStyle("border-spacing","0"),c.setStyle("border-collapse","collapse"));if(!this._.selectedElement){var l=c.append(g("colgroup")),d=c.append(g("tbody")),h=parseInt(b.txtRows,10)||0,p=parseInt(b.txtCols,10)||0;b.txtWidth||(b.txtWidth=z(a));var k=POLARIS.tools.convertToPx(b.txtWidth+a.lang.common.unitMm),n=POLARIS.plugins.tabletools.getSplittedCellSize(k,p),k=f.getStartElement(),
k=a.elementPath(k),q={},r={};q["line-height"]=a.config.tableLineHeight?a.config.tableLineHeight:y(k,"line-height");r["font-family"]=a.config.documentFontFamily?a.config.documentFontFamily:y(k,"font-family");r["font-size"]=a.config.documentFontSize?a.config.documentFontSize+"pt":y(k,"font-size");for(k=0;k<p;k++)l.append(g("col")).setStyle("width",POLARIS.tools.cssLength(n[k]));for(k=0;k<h;k++){for(var l=d.append(g("tr")),w=0;w<p;w++){var u=l.append(g("td"));u.setStyle("width",POLARIS.tools.cssLength(n[w]));
u.setStyle("height","36px");u.setStyle("vertical-align","top");u.setStyle("padding","2mm");var t=new POLARIS.dom.element("p"),v=new POLARIS.dom.element("span");v.setStyles(r);v.setHtml("\x26#8203;");t.append(v);t.setStyles(q);u.append(t)}l.setStyle("height","36px")}}h=b.selHeaders;if(!c.$.tHead&&("row"==h||"both"==h)){p=new POLARIS.dom.element(c.$.createTHead());d=c.getElementsByTag("tbody").getItem(0);d=d.getElementsByTag("tr").getItem(0);for(k=0;k<d.getChildCount();k++)l=d.getChild(k),l.type!=POLARIS.NODE_ELEMENT||
l.data("polaris-bookmark")||(l.renameNode("th"),l.setAttribute("scope","col"));p.append(d.remove())}if(null!==c.$.tHead&&"row"!=h&&"both"!=h){p=new POLARIS.dom.element(c.$.tHead);d=c.getElementsByTag("tbody").getItem(0);for(l=d.getFirst();0<p.getChildCount();){d=p.getFirst();for(k=0;k<d.getChildCount();k++)n=d.getChild(k),n.type==POLARIS.NODE_ELEMENT&&(n.renameNode("td"),n.removeAttribute("scope"));d.insertBefore(l)}p.remove()}if(!this.hasColumnHeaders&&("col"==h||"both"==h))for(l=0;l<c.$.rows.length;l++)n=
new POLARIS.dom.element(c.$.rows[l].cells[0]),n.renameNode("th"),n.setAttribute("scope","row");if(this.hasColumnHeaders&&"col"!=h&&"both"!=h)for(k=0;k<c.$.rows.length;k++)l=new POLARIS.dom.element(c.$.rows[k]),"tbody"==l.getParent().getName()&&(n=new POLARIS.dom.element(l.$.cells[0]),n.renameNode("td"),n.removeAttribute("scope"));c.removeStyle("height");(function(f){function e(f,c){if(c){var b;b=(b=x(f,"mm",!0))?parseInt(c)/b:1;f.removeAttribute("width");f.setStyle("width",c+a.lang.common.unitMm);
if(b&&1!=b){var d=f.findOne("colgroup");if(d=d&&d.find("col")){var h=d.count(),m,g,l;for(m=0;m<h;m++)g=d.getItem(m),l=Math.round(POLARIS.plugins.tabletools.getColWidth(g)*b),g.setStyle("width",l+"px"),g.hasAttribute("width")&&g.removeAttribute("width")}m=f.$.rows;g=f.$.rows.length;for(var k,n,p,d=0;d<g;d++)for(l=m[d].cells,k=l.length,h=0;h<k;h++)n=new POLARIS.dom.element(l[h]),p=x(n,"px")*b,n.setStyle("width",POLARIS.tools.cssLength(p))}}else f.removeStyle("width")}if(m){var b,d=m.length;for(b=0;b<
d;b++)e(m[b],f)}else e(c,f)})(b.txtWidth);(function(a){if(m){var f,e=m.length;for(f=0;f<e;f++){var b=m[f];a?b.setAttribute("align",a):b.removeAttribute("align")}}else a?c.setAttribute("align",a):c.removeAttribute("align")})(b.cmbAlign);if(this._.selectedElement)c.removeAttribute("bgColor"),c.removeAttribute("border"),c.removeAttribute("borderColor");else for(c.setStyle("border-width","0px"),c.setStyle("border-color","#000000"),c.setStyle("border-style","solid"),k=0,h=c.$.rows.length;k<h;k++)for(l=
c.$.rows[k],w=0,d=l.cells.length;w<d;w++)u=new POLARIS.dom.element(l.cells[w]),p=POLARIS.tools.cssLength("0.12mm"),u.setStyle("border-width",p),u.setStyle("border-color","#000000"),u.setStyle("border-style","solid");"yes"==b.tableLayout?c.setStyle("word-break","break-all"):c.removeStyle("word-break");c.getAttribute("style")||c.removeAttribute("style")}if(this._.selectedElement)try{f.selectBookmarks(e)}catch(A){}else a.insertElementWithBlockSplit(c),POLARIS.plugins.pagination.updateSplitId(c.getNext());
a.fire("tableresize")}},contents:[{id:"info",label:a.lang.common.generalTab,elements:[{type:"hbox",styles:["vertical-align:top"],children:[{type:"text",id:"txtRows",maxLength:2,"default":3,label:a.lang.table.rows,required:!0,validate:v(a.lang.table.invalidRows,1,25),setup:function(a){a=POLARIS.tools.tableMap.findSplitedTables(a);if(1===a.length)this.setValue(a[0].$.rows.length);else{var e=[];a.forEach(function(a){var f=a.$.rows;a=function(a){a=f[a];var c=a.getAttribute("data-split-id");c&&-1!==POLARIS.tools.indexOf(e,
function(a){return a.getAttribute("data-split-id")==c})||e.push(a)};for(var b=0;b<f.length;b++)a(b)});this.setValue(e.length)}},commit:q},{type:"text",id:"txtCols",maxLength:2,"default":2,label:a.lang.table.columns,required:!0,validate:v(a.lang.table.invalidCols,1,25),setup:function(a){this.setValue(A(a))},commit:q}]},{type:"hbox",styles:["vertical-align:top"],children:[{type:"text",id:"txtWidth",maxLength:3,requiredContent:"table{width}",label:a.lang.common.width,"default":"",validate:function(){if(a.config.wordprocessor){var f=
POLARIS.tools.getContentSizeToUnit(a,"mm").width,e=this.getValue(),e=!!(POLARIS.dialog.validate.integer()(e)&&1<=e&&e<f);e||(alert(a.lang.table.invalidWidth.replace("%1",f)),this.setValue(f-1),this.select());return e}return POLARIS.dialog.validate.number(a.lang.common.invalidWidth)},onChange:function(){var a=this.getDialog().getContentElement("advanced","advStyles");a&&a.updateStyle("width",this.getValue())},setup:function(a){a=x(a,"mm",!0);this.setValue(a)},commit:q},{type:"vbox",children:[{type:"html",
html:"\x26nbsp;"},{type:"html",html:a.lang.common.unitMm,style:"line-height: 30px;"}]}]},{type:"hbox",styles:["vertical-align:top"],widths:["50%","35%","15%"],children:[{id:"cmbAlign",type:"select",requiredContent:"table[align]","default":"",label:a.lang.common.align,items:[[a.lang.common.alignLeft,""],[a.lang.common.alignCenter,"center"],[a.lang.common.alignRight,"right"]],setup:function(a){this.setValue(a.getAttribute("align")||"")},commit:q},{id:"cmbCellSpacing",type:"text",hidden:"CLOUD ONNARA"==
a.config.customer||"SNT"==a.config.customer?!0:!1,requiredContent:"table[cellSpacing]",maxLength:2,"default":"0",validate:v(a.lang.table.invalidCellSpacing,0,50),label:a.lang.table.cellSpacing,setup:function(a){this.setValue(parseFloat(a.getStyle("border-spacing"))||"0")},commit:q},{type:"vbox",hidden:"CLOUD ONNARA"==a.config.customer||"SNT"==a.config.customer?!0:!1,children:[{type:"html",style:"line-height: 22px;",html:"\x26nbsp;"},{type:"html",html:a.lang.common.unitPt}]}]},{type:"hbox",styles:["vertical-align:top"],
children:[{type:"select",hidden:!0,id:"selBorderWidth",width:"120px",requiredContent:"table[border]","default":a.lang.table.borderWidth[2][0],label:a.lang.table.border,items:[[a.lang.table.borderWidth[0][0],a.lang.table.borderWidth[0][1]],[a.lang.table.borderWidth[1][0],a.lang.table.borderWidth[1][1]],[a.lang.table.borderWidth[2][0],a.lang.table.borderWidth[2][1]],[a.lang.table.borderWidth[3][0],a.lang.table.borderWidth[3][1]],[a.lang.table.borderWidth[4][0],a.lang.table.borderWidth[4][1]],[a.lang.table.borderWidth[5][0],
a.lang.table.borderWidth[5][1]],[a.lang.table.borderWidth[6][0],a.lang.table.borderWidth[6][1]],[a.lang.table.borderWidth[7][0],a.lang.table.borderWidth[7][1]],[a.lang.table.borderWidth[8][0],a.lang.table.borderWidth[8][1]],[a.lang.table.borderWidth[9][0],a.lang.table.borderWidth[9][1]],[a.lang.table.borderWidth[10][0],a.lang.table.borderWidth[10][1]],[a.lang.table.borderWidth[11][0],a.lang.table.borderWidth[11][1]],[a.lang.table.borderWidth[12][0],a.lang.table.borderWidth[12][1]],[a.lang.table.borderWidth[13][0],
a.lang.table.borderWidth[13][1]],[a.lang.table.borderWidth[14][0],a.lang.table.borderWidth[14][1]],[a.lang.table.borderWidth[15][0],a.lang.table.borderWidth[15][1]],[a.lang.table.borderWidth[16][0],a.lang.table.borderWidth[16][1]]],setup:function(){},commit:function(){}},{id:"selBorderStyle",type:"select",hidden:!0,width:"120px",requiredContent:"table[border]","default":"solid",label:a.lang.table.tableBorderStyle,items:[[a.lang.table.borderStyle.border_none,"none"],[a.lang.table.borderStyle.border_dotted,
"dotted"],[a.lang.table.borderStyle.border_dashed,"dashed"],[a.lang.table.borderStyle.border_solid,"solid"],[a.lang.table.borderStyle.border_double,"double"]],setup:function(){},commit:function(){}}]},{type:"hbox",hidden:!0,styles:["vertical-align:top"],children:[{type:"html",id:"tableBgColor",html:'\x3cp style\x3d"height:16px;\x3e\x3cspan\x3e'+a.lang.table.tableBgColor+'\x3c/span\x3e\x3c/p\x3e\x3cdiv id\x3d"'+t+'"class\x3d"polaris_dialog_ui_colorpanel" style\x3d"width: 78px;"\x3e\x3c/div\x3e',setup:function(a){},
commit:function(a){}},h?{type:"button",id:"tableBgColorChoose","class":"colorChooser",label:a.lang.common.chooseColor,onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){a.getUIColorFromDialog(function(a){a&&POLARIS.document.getById(t).setStyle("background-color",a)},this)}}:d,{type:"html",id:"tableBorderColor",html:'\x3cp style\x3d"height:16px;\x3e\x3cspan\x3e'+a.lang.table.tableBorderColor+'\x3c/span\x3e\x3c/p\x3e\x3cdiv id\x3d"'+r+'"class\x3d"polaris_dialog_ui_colorpanel" style\x3d"width: 78px; background-color: #000000"\x3e\x3c/div\x3e',
setup:function(a){},commit:function(a){}},h?{type:"button",id:"tableBorderColorChoose","class":"colorChooser",label:a.lang.common.chooseColor,onLoad:function(){this.getElement().getParent().setStyle("vertical-align","bottom")},onClick:function(){a.getUIColorFromDialog(function(a){a&&POLARIS.document.getById(r).setStyle("background-color",a)},this)}}:d]},{type:"hbox",id:"imagebox",hidden:"CLOUD ONNARA"==a.config.customer||"SNT"==a.config.customer||a.config.useImageBase64Encoding?!0:!1,children:[{id:"txtPath",
type:"text",style:"width: 172px;",label:a.lang.table.bgImage,required:!0,setup:function(a){a=a.getComputedStyle("background-image")||"";a="none"==a?"":a.replace(/url\(\s*(["']?)\s*([^\)]*)\s*\1\s*\)/i,function(a,f,b){return b});this.setValue(a)},commit:function(a,e){e.removeAttribute("background");var c=this.getValue();c?(c=c.replace(/ /g,"%20"),e.setStyle("background-image","url("+c+")")):e.removeStyle("background-image")}},{type:"vbox",filebrowser:"uploadButton",label:a.lang.image.upload,style:"width: 66px",
children:[{type:"file",id:"upload",style:"width:100%",hidden:!0,label:a.lang.image.btnUpload,size:38},{type:"fileButton",id:"uploadButton",style:"width:100%",filebrowser:"info:txtPath",label:a.lang.image.btnUpload,"for":["info","upload"]}]}]},{type:"select",id:"repeat",hidden:"CLOUD ONNARA"==a.config.customer||"SNT"==a.config.customer||a.config.useImageBase64Encoding?!0:!1,label:a.lang.table.repeatLabel,"default":"repeat",items:[[a.lang.table.notRepeat,"no-repeat"],[a.lang.table.repeat,"repeat"],
[a.lang.table.horizontalRepeat,"repeat-x"],[a.lang.table.verticalRepeat,"repeat-y"]],setup:function(a){a=a.getComputedStyle("background-repeat")||"";""==a?this.setValue("no-repeat"):this.setValue(a)},commit:function(a,e){var c=this.getValue();this.getDialog().getContentElement("info","txtPath").getValue()&&c?e.setStyle("background-repeat",c):e.removeStyle("background-repeat")}}]},{id:"advanced",hidden:!0,label:a.lang.common.advancedTab,elements:[{type:"select",id:"selHeaders",requiredContent:"th",
"default":"",label:a.lang.table.headers,items:[[a.lang.table.headersNone,""],[a.lang.table.headersRow,"row"],[a.lang.table.headersColumn,"col"],[a.lang.table.headersBoth,"both"]],setup:function(a){var e=this.getDialog();e.hasColumnHeaders=!0;for(var c=0;c<a.$.rows.length;c++){var b=a.$.rows[c].cells[0];if(b&&"th"!=b.nodeName.toLowerCase()){e.hasColumnHeaders=!1;break}}null!==a.$.tHead?this.setValue(e.hasColumnHeaders?"both":"row"):this.setValue(e.hasColumnHeaders?"col":"")},commit:q},{type:"radio",
id:"tableLayout",label:a.lang.table.tableLayout,"default":"yes",items:[[a.lang.table.fixed,"yes"],[a.lang.table.auto,"no"]],setup:function(a){"break-all"==a.getStyle("word-break")?this.setValue("yes"):this.setValue("no")},commit:function(a,b){var c=this.id;a.info||(a.info={});a.info[c]=this.getValue();"yes"==this.getValue()?b.setStyle("word-break","break-all"):b.removeStyle("word-break")}},{type:"text",id:"linkId",requiredContent:"table[id]",label:a.lang.common.id,setup:function(a){this.setValue(a.getAttribute("id"))},
commit:function(a,b){this.getValue()||this.isChanged()?b.setAttribute("id",this.getValue()):b.removeAttribute("id")}},{id:"cmbLangDir",type:"select",requiredContent:"table[dir]",label:a.lang.common.langDir,"default":"",items:[[a.lang.common.notSet,""],[a.lang.common.langDirLtr,"ltr"],[a.lang.common.langDirRtl,"rtl"]],setup:function(a){this.setValue(a.getAttribute("dir"))},commit:function(a,b){this.getValue()?b.setAttribute("dir",this.getValue()):b.removeAttribute("dir")}},{type:"text",id:"txtSummary",
requiredContent:"table[summary]",label:a.lang.table.summary,setup:function(a){this.setValue(a.getAttribute("summary")||"")},commit:function(a,b){this.getValue()?b.setAttribute("summary",this.getValue()):b.removeAttribute("summary")}},{type:"hbox",children:[{type:"text",id:"txtCaption",requiredContent:"caption",width:"181px",label:a.lang.table.caption,setup:function(a){this.enable();a=a.getElementsByTag("caption");if(0<a.count()){a=a.getItem(0);var b=a.getFirst(POLARIS.dom.walker.nodeType(POLARIS.NODE_ELEMENT));
b&&!b.equals(a.getBogus())?(this.disable(),this.setValue(a.getText())):(a=POLARIS.tools.trim(a.getText()),this.setValue(a))}},commit:function(b,e){if(this.isEnabled()){var c=this.getValue(),d=e.getElementsByTag("caption");if(c)0<d.count()?(d=d.getItem(0),d.setHtml("")):(d=new POLARIS.dom.element("caption",a.document),e.getChildCount()?d.insertBefore(e.getFirst()):d.appendTo(e)),d.append(new POLARIS.dom.text(c,a.document));else if(0<d.count())for(c=d.count()-1;0<=c;c--)d.getItem(c).remove()}}},{type:"vbox",
padding:0,children:[{type:"html",html:"\x26nbsp;"},{type:"checkbox",id:"chkCaption",style:"margin-top: 2px;","default":!0,label:a.lang.table.chkcaption,setup:function(a){a=a.getElementsByTag("caption");0<a.count()&&("none"==a.getItem(0).getStyle("display")?this.setValue(!1):this.setValue(!0))},commit:function(a,b){var c=b.getElementsByTag("caption");0<c.count()&&(c=c.getItem(0),0==this.getValue()?c.setStyle("display","none"):c.removeStyle("display"))}}]}]}]}]}}var q=function(a){var b=this.id;a.info||
(a.info={});a.info[b]=this.getValue()};POLARIS.dialog.add("table",function(a){return t(a,"table")});POLARIS.dialog.add("tableProperties",function(a){return t(a,"tableProperties")})})();