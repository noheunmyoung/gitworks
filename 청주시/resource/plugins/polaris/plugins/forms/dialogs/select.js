POLARIS.dialog.add("select",function(e){function h(a,b,c,d,e){a=f(a);d=d?d.createElement("OPTION"):document.createElement("OPTION");if(a&&d&&"option"==d.getName())POLARIS.env.ie?(isNaN(parseInt(e,10))?a.$.options.add(d.$):a.$.options.add(d.$,e),d.$.innerHTML=0<b.length?b:"",d.$.value=c):(null!==e&&e<a.getChildCount()?a.getChild(0>e?0:e).insertBeforeMe(d):a.append(d),d.setText(0<b.length?b:""),d.setValue(c));else return!1;return d}function p(a){a=f(a);for(var b=g(a),c=a.getChildren().count()-1;0<=
c;c--)a.getChild(c).$.selected&&a.getChild(c).remove();k(a,b)}function q(a,b,c,d){a=f(a);if(0>b)return!1;a=a.getChild(b);a.setText(c);a.setValue(d);return a}function m(a){a=f(a);if(POLARIS.env.ie)for(;0<a.$.length;)a.$.remove(a.$.length-1);else for(;a.getChild(0)&&a.getChild(0).remove(););}function l(a,b,c){a=f(a);var d=g(a);if(0>d)return!1;b=d+b;b=0>b?0:b;b=b>=a.getChildCount()?a.getChildCount()-1:b;if(d==b)return!1;var d=a.getChild(d),e=d.getText(),r=d.getValue();d.remove();d=h(a,e,r,c?c:null,b);
k(a,b);return d}function g(a){return(a=f(a))?a.$.selectedIndex:-1}function k(a,b){a=f(a);if(0>b)return null;var c=a.getChildren().count();a.$.selectedIndex=b>=c?c-1:b;return a}function n(a){return(a=f(a))?a.getChildren():!1}function f(a){return a&&a.domId&&a.getInputElement().$?a.getInputElement():a&&a.$?a:!1}return{title:e.lang.forms.select.title,minWidth:244,minHeight:310,resizable:POLARIS.DIALOG_RESIZE_NONE,onShow:function(){delete this.selectBox;this.setupContent("clear");var a=this.getParentEditor().getSelection().getSelectedElement();
if(a&&"select"==a.getName()){this.selectBox=a;this.setupContent(a.getName(),a);for(var a=n(a),b=0;b<a.count();b++)this.setupContent("option",a.getItem(b))}},onOk:function(){var a=this.getParentEditor(),b=this.selectBox,c=!b;c&&(b=a.document.createElement("select"));this.commitContent(b);if(c&&(a.insertElement(b),POLARIS.env.ie)){var d=a.getSelection(),e=d.createBookmarks();setTimeout(function(){d.selectBookmarks(e)},0)}},contents:[{id:"info",label:e.lang.forms.select.selectInfo,title:e.lang.forms.select.selectInfo,
accessKey:"",elements:[{id:"txtName",type:"text",labelLayout:"vertical",label:e.lang.common.name,"default":"",accessKey:"N",setup:function(a,b){"clear"==a?this.setValue(this["default"]||""):"select"==a&&this.setValue(b.data("polaris-saved-name")||b.getAttribute("name")||"")},commit:function(a){this.getValue()?(a.data("polaris-saved-name",this.getValue()),a.setAttribute("name",this.getValue())):(a.data("polaris-saved-name",!1),a.removeAttribute("name"))}},{id:"txtValue",type:"text",labelLayout:"vertical",
label:e.lang.forms.select.value,"default":"",className:"polaris_disabled",onLoad:function(){this.getInputElement().setAttribute("disabled",!0)},setup:function(a,b){this.getInputElement().setAttribute("disabled",!0);"clear"==a?this.setValue(""):"option"==a&&b.getAttribute("selected")&&this.setValue(b.$.value)}},{id:"txtSize",type:"text",labelLayout:"vertical",label:e.lang.forms.select.size,"default":"",accessKey:"S",maxLength:2,validate:function(){var a=POLARIS.dialog.validate.integer(e.lang.common.validateNumberFailed);
return""===this.getValue()||a.apply(this)},setup:function(a,b){"select"==a&&this.setValue(b.getAttribute("size")||"")},commit:function(a){this.getValue()?a.setAttribute("size",this.getValue()):a.removeAttribute("size")}},{id:"chkMulti",type:"checkbox",label:e.lang.forms.select.chkMulti,"default":"",accessKey:"M",value:"checked",setup:function(a,b){"select"==a&&this.setValue(b.getAttribute("multiple"));POLARIS.env.webkit&&this.getElement().getParent().setStyle("vertical-align","middle")},commit:function(a){this.getValue()?
a.setAttribute("multiple",this.getValue()):a.removeAttribute("multiple")}},{type:"hbox",children:[{id:"txtOptName",type:"text",label:e.lang.forms.select.opText,style:"width:100px",setup:function(a){"clear"==a&&this.setValue("")}},{id:"txtOptValue",type:"text",label:e.lang.forms.select.opValue,style:"width:76px",setup:function(a){"clear"==a&&this.setValue("")}},{type:"html",html:"\x26nbsp;"}]},{type:"hbox",children:[{type:"vbox",children:[{type:"select",id:"cmbName",label:"",title:"",size:5,style:"width:100px;height:92px;",
items:[],onChange:function(){var a=this.getDialog(),b=a.getContentElement("info","cmbValue"),c=a.getContentElement("info","txtOptName"),a=a.getContentElement("info","txtOptValue"),d=g(this);k(b,d);c.setValue(this.getValue());a.setValue(b.getValue())},setup:function(a,b){"clear"==a?m(this):"option"==a&&h(this,b.getText(),b.getText(),this.getDialog().getParentEditor().document)},commit:function(a){var b=this.getDialog(),c=n(this),d=n(b.getContentElement("info","cmbValue")),e=b.getContentElement("info",
"txtValue").getValue();m(a);for(var f=0;f<c.count();f++){var g=h(a,c.getItem(f).getValue(),d.getItem(f).getValue(),b.getParentEditor().document);d.getItem(f).getValue()==e&&(g.setAttribute("selected","selected"),g.selected=!0)}}}]},{type:"vbox",children:[{type:"select",id:"cmbValue",label:"",size:5,style:"width:76px;height:92px;",items:[],onChange:function(){var a=this.getDialog(),b=a.getContentElement("info","cmbName"),c=a.getContentElement("info","txtOptName"),a=a.getContentElement("info","txtOptValue"),
d=g(this);k(b,d);c.setValue(b.getValue());a.setValue(this.getValue())},setup:function(a,b){if("clear"==a)m(this);else if("option"==a){var c=b.getValue();h(this,c,c,this.getDialog().getParentEditor().document);"selected"==b.getAttribute("selected")&&this.getDialog().getContentElement("info","txtValue").setValue(c)}}}]},{type:"vbox",style:"width:60px;height:92px;",children:[{type:"button",id:"btnAdd",label:e.lang.forms.select.btnAdd,title:e.lang.forms.select.btnAdd,style:"width:58px;",onClick:function(){var a=
this.getDialog(),b=a.getContentElement("info","txtOptName"),c=a.getContentElement("info","txtOptValue"),d=a.getContentElement("info","cmbName"),f=a.getContentElement("info","cmbValue");""!=b.getValue()&&""!=c.getValue()?(h(d,b.getValue(),b.getValue(),a.getParentEditor().document),h(f,c.getValue(),c.getValue(),a.getParentEditor().document),b.setValue(""),c.setValue("")):alert(e.lang.forms.select.invalidAddTextVaule)}},{type:"button",id:"btnModify",label:e.lang.forms.select.btnModify,title:e.lang.forms.select.btnModify,
style:"width:58px;",onClick:function(){var a=this.getDialog(),b=a.getContentElement("info","txtOptName"),c=a.getContentElement("info","txtOptValue"),d=a.getContentElement("info","cmbName"),a=a.getContentElement("info","cmbValue"),f=g(d);""!=b.getValue()&&""!=c.getValue()?0<=f&&(q(d,f,b.getValue(),b.getValue()),q(a,f,c.getValue(),c.getValue())):alert(e.lang.forms.select.invalidModifyTextVaule)}},{type:"button",id:"btnUp",style:"width:58px;",label:e.lang.forms.select.btnUp,title:e.lang.forms.select.btnUp,
onClick:function(){var a=this.getDialog(),b=a.getContentElement("info","cmbName"),c=a.getContentElement("info","cmbValue");l(b,-1,a.getParentEditor().document);l(c,-1,a.getParentEditor().document)}},{type:"button",id:"btnDown",style:"width:58px;",label:e.lang.forms.select.btnDown,title:e.lang.forms.select.btnDown,onClick:function(){var a=this.getDialog(),b=a.getContentElement("info","cmbName"),c=a.getContentElement("info","cmbValue");l(b,1,a.getParentEditor().document);l(c,1,a.getParentEditor().document)}}]}]},
{type:"hbox",widths:["100px","76px","60px"],children:[{type:"button",id:"btnSetValue",style:"width:98px;text-align:center; margin-top:8px;",label:e.lang.forms.select.btnSetValue,title:e.lang.forms.select.btnSetValue,onClick:function(){var a=this.getDialog(),b=a.getContentElement("info","cmbValue");a.getContentElement("info","txtValue").setValue(b.getValue())}},{type:"button",id:"btnDelete",style:"width:74px;text-align:center; margin-top:8px;",label:e.lang.forms.select.btnDelete,title:e.lang.forms.select.btnDelete,
onClick:function(){var a=this.getDialog(),b=a.getContentElement("info","cmbName"),c=a.getContentElement("info","cmbValue"),d=a.getContentElement("info","txtOptName"),a=a.getContentElement("info","txtOptValue");p(b);p(c);d.setValue("");a.setValue("")}},{type:"html",html:"\x26nbsp;"}]}]}]}});