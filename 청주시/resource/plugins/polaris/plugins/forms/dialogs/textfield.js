POLARIS.dialog.add("textfield",function(b){function e(a){a=a.element;var c=this.getValue();c?a.setAttribute(this.id,c):a.removeAttribute(this.id)}function f(a){a=a.hasAttribute(this.id)&&a.getAttribute(this.id);this.setValue(a||"")}var g={email:1,password:1,search:1,tel:1,text:1,url:1};return{title:b.lang.forms.textfield.title,minWidth:180,minHeight:200,resizable:POLARIS.DIALOG_RESIZE_NONE,onShow:function(){delete this.textField;var a=this.getParentEditor().getSelection().getSelectedElement();!a||
"input"!=a.getName()||!g[a.getAttribute("type")]&&a.getAttribute("type")||(this.textField=a,this.setupContent(a))},onOk:function(){var a=this.getParentEditor(),c=this.textField,b=!c;b&&(c=a.document.createElement("input"),c.setAttribute("type","text"));c={element:c};b&&a.insertElement(c.element);this.commitContent(c);b||a.getSelection().selectElement(c.element)},onLoad:function(){this.foreach(function(a){a.getValue&&(a.setup||(a.setup=f),a.commit||(a.commit=e))})},contents:[{id:"info",label:b.lang.forms.textfield.title,
title:b.lang.forms.textfield.title,elements:[{id:"_polaris_saved_name",type:"text",label:b.lang.forms.textfield.name,"default":"",accessKey:"N",setup:function(a){this.setValue(a.data("polaris-saved-name")||a.getAttribute("name")||"")},commit:function(a){a=a.element;this.getValue()?(a.data("polaris-saved-name",this.getValue()),a.setAttribute("name",this.getValue())):(a.data("polaris-saved-name",!1),a.removeAttribute("name"))}},{id:"value",type:"text",label:b.lang.forms.textfield.value,maxLength:"10",
"default":"",accessKey:"V",validate:function(){return function(){var a=this.getValue(),c=this.getDialog().getValueOf("info","maxLength"),d=!0;0<c&&(d=!!(0<=a.length&&a.length<=c));d||(alert(b.lang.forms.textfield.invalidValue),this.select());return d}}(),commit:function(a){if(POLARIS.env.ie&&!this.getValue()){var c=a.element,d=new POLARIS.dom.element("input",b.document);c.copyAttributes(d,{value:1});d.replace(c);a.element=d}else e.call(this,a)}},{id:"size",type:"text",label:b.lang.forms.textfield.charWidth,
"default":"",accessKey:"C",validate:POLARIS.dialog.validate.integer(b.lang.common.validateNumberFailed)},{id:"maxLength",type:"text",label:b.lang.forms.textfield.maxChars,"default":"",accessKey:"M",validate:POLARIS.dialog.validate.integer(b.lang.common.validateNumberFailed)},{id:"type",type:"select",label:b.lang.forms.textfield.type,"default":"text",accessKey:"M",items:[[b.lang.forms.textfield.typeEmail,"email"],[b.lang.forms.textfield.typePass,"password"],[b.lang.forms.textfield.typeSearch,"search"],
[b.lang.forms.textfield.typeTel,"tel"],[b.lang.forms.textfield.typeText,"text"],[b.lang.forms.textfield.typeUrl,"url"]],setup:function(a){this.setValue(a.getAttribute("type"))},commit:function(a){var c=a.element;if(POLARIS.env.ie){var d=c.getAttribute("type"),e=this.getValue();d!=e&&(d=POLARIS.dom.element.createFromHtml('\x3cinput type\x3d"'+e+'"\x3e\x3c/input\x3e',b.document),c.copyAttributes(d,{type:1}),d.replace(c),a.element=d)}else c.setAttribute("type",this.getValue())}}]}]}});